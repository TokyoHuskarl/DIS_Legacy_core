#include "./../headers/header_drawing.tpc"

defs S_OpenInv = 64

__fn get_selected_agent_data {
	    @if s[25] .isOff() {
		v[341] = v[101]
		
	    } .else bl {
		v[341] = v[100]
		
	    }
	    v[145] = v[341]
	    v[325] = v[341] * 300
	    v[325] += 4701
	    v[v[325]].copy v[601], 300
	    v[159] = v[899]
	    v[555..556] = 996
}


//This one is really awful, you will fear how this is written 
cev .id(85), .name("GameUI:Inventory"),{


	S_OpenInv.on
	s[19].on
	@if s[2] .isOff() {
	    @call .cev 2094
	    
	}
	@label.set 10
	@pic[996].erase
	@pic[1765].erase
	@pic[1230..1300].erase
	@pic[1500..1600].erase
	@comment "Inventry Const"
	v[1247] = 16
	v[1245] = 11
	v[341] = v[174] + 1951
	@call .cev v[341]
	@comment "Inventry mode"
	s[18].off
	s[38].on
	s[43].on
	@comment "Inventry mode switches end"
	v[342] = v[1116] + 9
	@comment "def 84 12"
	v[157] = v[1001] / 6
	v[158] = v[1002] / 8
	v[341] = v[157] - 4
	v[342] = v[158] - 12
	@pic[1231].show {
	    "ui\inventoryUIBase"
	    .pos v[341], v[342] .topLeft
	    .chromakey 1
	    .scale 100
	    .trans 0
	    .rgbs 100, 100, 100, 100
	    .mapLayer 9
	    .affectedByShake
	}
	@if s[20] .isOn() {
	    s[39].off
	    s[51].off
	    @pic[2135].strpic {
		""
		.pos 0, 0 .topLeft
		.size v[1001], v[1002]        .chromakey 1
		.scale 100
		.trans 40
		.rgbs 100, 100, 100, 100
		.font "", 12 .noShadow
		.spacing 0, 4
		.skin "" .stretch .noframe .noGradation .noPadding
		.mapLayer 8
		.eraseWhenTransfer
		.affectedByFlash
		.affectedByShake
	    }
	    get_selected_agent_data()

	    
	} .else bl {
	    @call .cev 1946
	    v[284] = (v[256] - 1) * 300 + v[1261] - 1
	    @call .cev 1948
	    
	}
	@if v[661] != 0 {
	    v[172] = v[1193]
	    v[171] = v[1191]
	    v[661] *= -1
	    v[173] = v[661]
	    
	} .else bl {
	    v[175] = -1
	    
	}
	v[1241] = 140
	v[1242] = 10
	v[1248] = 248
	v[1243] = v[157] + v[1248]
	v[1244] = v[158] + 40
	v[352] = v[1244]
	@if v[661] == 0 {
	    v[350] = 1233
	    v[351] = 152
	    @comment "Perks"
	    v[1243] = v[157] + v[1248]
	    t[503] .asg ""
	    t[505] .asg t[20034]
	    @comment "Load"
	    v[1942] = v[701]
	    v[1941] = v[1215] + v[1942]
	    t[2998] .asg t[v[1941]]
	    t[2998] .split ",", t[2998], v[1941]
	    t[503] .asg t[2999]
	    t[505] .asg t[3000]
	    t[501] .asg t[503]
	    @comment "#SetPerks"
	    v[605..610] = 0
	    @comment "#Perks1"
	    @loop 4 .dst v[1950] {
		v[v[1216]..v[1216] + 100] = 0
		v[1949] = v[1950] + 3041
		t[v[1949]] .split "|", t[3200], v[1941]
		@loop v[1941] .dst v[1945] {
		    v[1942] = 3200 + v[1945]
		    v[1943] = v[1216] + v[1945]
		    t[v[1942]] .toNum v[1944]
		    v[v[1943]] = v[1944]
		    
		}
		
		@loop v[1941] .dst v[1945] {
		    v[1943] = v[1216] + v[1945]
		    v[606 + v[1950]] |= pow(2, v[v[1943]] - 1)
		    
		}
		
		
	    }
	    
	    @loop 100 .dst v[343] {
		v[12] = v[343] + 1
		@comment "#####################"
		v[21] = -1
		v[22] = 1
		@comment "v1=CompanionID
	v2=PerkID
	reg1 # 0 == cant 1==can be used 2==currently used
	reg2 # Icon ID"
		@comment "Load"
		v[1941] = v[1214] + v[12]
		t[2999] .asg t[v[1941]]
		t[2999] .split ",", t[2999], v[1941]
		t[503] .asg t[2999]
		t[504] .asg t[3000]
		v[13] = 600
		@if t[2999] .eq "0" {
		    v[21] = -1
		    
		} .else bl {
		    @loop 7 .dst v[1941] {
			v[1942] = 3001 + v[1941]
			v[1943] = 1901 + v[1941]
			t[v[1942]] .toNum v[1944]
			v[v[1943]] = v[1944]
			t[v[1942]] .asg ""
			
		    }
		    
		    @comment "V4 = Flag
	V5 = where to flag Perk Bit 
	v6 #1 = Battle 2=magic
	v7 = how much perk points you have to invest in this tree to get"
		    v[0] = v[14..17] = v[1901..1904]
		    @comment "Check if the perk used or not"
		    v[21] = (v[v[13] + 5 + v[15]] & v[14]) == v[14] ? 2 : 1
		    @comment "If the perk not used, check if the character can get it at the point"
		    @if v[21] <= 1 {
			v[21] = v[v[13] + 150 + v[16]] >= v[17] ? 1 : 0
			
		    }
		    @comment "Icon Set"
		    v[22] = v[1905]
		    
		}
		@comment "####################"
		v[21] -= v[v[13] + 91] < 1 && v[21] == 1 ? 1 : 0
		@comment "####################"
		v[23] = v[1901]
		v[24] = v[1902]
		@comment "#####################"
		v[350] = 1500 + v[343]
		v[351] = v[1243] + 4 + v[343] % 10 * 21
		v[352] = v[1244] + 10 + v[343] / 10 * 17
		@if v[21] == 0 {
		    @pic[v[350]].show {
			"ui\PerkIcons"
			.pos v[351], v[352] .center
			.chromakey 1
			.scale 100
			.trans 0
			.rgbs 20, 20, 20, 0
			.grid 16, 15 .cell v[22]
			.mapLayer 9
			.eraseWhenTransfer
			.affectedByFlash
			.affectedByShake
		    }
		    
		} .else bl {
		    @if v[21] == 1 {
			@pic[v[350]].show {
			    "ui\PerkIcons"
			    .pos v[351], v[352] .center
			    .chromakey 1
			    .scale 100
			    .trans 0
			    .rgbs 60, 60, 60, 0
			    .grid 16, 15 .cell v[22]
			    .mapLayer 9
			    .eraseWhenTransfer
			    .affectedByFlash
			    .affectedByShake
			}
			
		    } .else bl {
			@if v[21] == 2 {
			    @pic[v[350]].show {
				"ui\PerkIcons"
				.pos v[351], v[352] .center
				.chromakey 1
				.scale 100
				.trans 0
				.rgbs 100, 100, 100, 100
				.grid 16, 15 .cell v[22]
				.mapLayer 9
				.eraseWhenTransfer
				.affectedByFlash
				.affectedByShake
			    }
			    
			} .else bl {
			    @if s[1] .isOn() {
				@pic[v[350]].show {
				    "ui\PerkIcons"
				    .pos v[351], v[352] .center
				    .chromakey 1
				    .scale 100
				    .trans 0
				    .rgbs 30, 30, 30, 0
				    .grid 16, 15 .cell 65
				    .mapLayer 9
				    .eraseWhenTransfer
				    .affectedByFlash
				    .affectedByShake
				}
				
			    }
			    
			}
			
		    }
		    
		}
		
	    }
	    
	    v[350] = 1233
	    
	} .else bl {
	    v[175] = v[175] <= 0 ? 0 : v[175]
	    @if v[175] == 0 {
		@call .cev 1950
		
	    } .else bl {
		@if v[175] == 1 {
		    
		} .else bl {
		    @if v[175] == 2 {
			@call .cev 1990
			
		    }
		    
		}
		
	    }
	    
	}
	v[350] += 1
	v[354] = v[157] + 62
	v[355] = v[158] + 54
	v[306] = v[158] + 54
	v[553] = v[350]
	@pic[v[350]].show {
	    "passive_icon\picon_0" .repl 1 v[822]
	    .pos v[354], v[355] .center
	    .chromakey 1
	    .scale 100
	    .trans 0
	    .rgbs 100, 100, 100, 100
	    .mapLayer 9
	    .affectedByShake
	}
	@if s[1] .isOff() {
	    v[350] += 1
	    @if s[20] .isOn() {
		@if s[25] .isOff() {
		    v[340] = v[101]
		    
		} .else bl {
		    v[340] = v[100]
		    
		}
		
	    } .else bl {
		v[340] = 1
		
	    }
	    v[160] = v[350]
	    v[325] -= 1
	    @comment "#########################"
	    function_draw_agent_inv_stats()	
	    
	    v[325] += 1
	    
	}
	v[350] += 3
	v[341] = v[700] == 0 ? 2 : 17
	@call .cev 200
	v[353] = v[157] + 4
	v[354] = v[158] + 21
	t[526] .asg t[v[145]]
	@pic[v[350]].strpic {
	    "\t[526]"
	    .pos v[353], v[354] .topLeft
	    .size 0, 0    .chromakey 1
	    .scale 100
	    .trans 0
	    .rgbs 100, 100, 100, 100
	    .font "", 10
	    .spacing 0, 0
	    .skin "" .nobg .noframe .noPadding
	    .mapLayer 9
	    .eraseWhenTransfer
	    .affectedByFlash
	    .affectedByShake
	}
	@call .cev 1933
	@comment "##
	Show Equipment"
	@if v[175] >= 0 {
	    v[350] += 1
	    v[11] = v[851]
	    v[353] = v[157] + 38
	    v[354] = v[158] + 82
	    v[355] = v[172] + (v[661] - 1) * 7 + 0
	    v[0] = v[542..548] = [v[350], v[350] + 1, v[350] + 2, v[350] + 3, v[350] + 4, v[350] + 5, v[350] + 6]
	    @pic[v[350]].strpic {
		"\t[\v[355]]"
		.pos v[353], v[354] .left
		.size 0, 0        .chromakey 1
		.scale 100
		.trans 0
		.rgbs 100, 100, 100, 100
		.font t[530], v[4511] .noShadow
		.spacing 0, 0
		.skin "" .nobg .noframe .noPadding
		.mapLayer 9
		.eraseWhenTransfer
		.affectedByFlash
		.affectedByShake
	    }
	    v[350] += 1
	    v[11] = v[852]
	    v[353] = v[157] + 38
	    v[354] += 11
	    v[355] = v[172] + (v[661] - 1) * 7 + 1
	    @pic[v[350]].strpic {
		"\t[\v[355]]"
		.pos v[353], v[354] .left
		.size 0, 0        .chromakey 1
		.scale 100
		.trans 0
		.rgbs 100, 100, 100, 100
		.font t[530], v[4511] .noShadow
		.spacing 0, 0
		.skin "" .nobg .noframe .noPadding
		.mapLayer 9
		.eraseWhenTransfer
		.affectedByFlash
		.affectedByShake
	    }
	    v[350] += 1
	    v[11] = v[853]
	    v[353] = v[157] + 33
	    v[354] += 11
	    v[355] = v[172] + (v[661] - 1) * 7 + 2
	    @pic[v[350]].strpic {
		"\t[\v[355]]"
		.pos v[353], v[354] .left
		.size 0, 0        .chromakey 1
		.scale 100
		.trans 0
		.rgbs 100, 100, 100, 100
		.font t[530], v[4511] .noShadow
		.spacing 0, 0
		.skin "" .nobg .noframe .noPadding
		.mapLayer 9
		.eraseWhenTransfer
		.affectedByFlash
		.affectedByShake
	    }
	    v[350] += 1
	    v[11] = v[854]
	    v[353] = v[157] + 28
	    v[354] += 11
	    v[355] = v[172] + (v[661] - 1) * 7 + 3
	    @pic[v[350]].strpic {
		"\t[\v[355]]"
		.pos v[353], v[354] .left
		.size 0, 0        .chromakey 1
		.scale 100
		.trans 0
		.rgbs 100, 100, 100, 100
		.font t[530], v[4511] .noShadow
		.spacing 0, 0
		.skin "" .nobg .noframe .noPadding
		.mapLayer 9
		.eraseWhenTransfer
		.affectedByFlash
		.affectedByShake
	    }
	    v[350] += 1
	    v[11] = v[855]
	    v[353] = v[157] + 28
	    v[354] += 11
	    v[355] = v[172] + (v[661] - 1) * 7 + 4
	    @pic[v[350]].strpic {
		"\t[\v[355]]"
		.pos v[353], v[354] .left
		.size 0, 0        .chromakey 1
		.scale 100
		.trans 0
		.rgbs 100, 100, 100, 100
		.font t[530], v[4511] .noShadow
		.spacing 0, 0
		.skin "" .nobg .noframe .noPadding
		.mapLayer 9
		.eraseWhenTransfer
		.affectedByFlash
		.affectedByShake
	    }
	    v[350] += 1
	    v[11] = v[856]
	    v[353] = v[157] + 33
	    v[354] += 11
	    v[355] = v[172] + (v[661] - 1) * 7 + 5
	    @pic[v[350]].strpic {
		"\t[\v[355]]"
		.pos v[353], v[354] .left
		.size 0, 0        .chromakey 1
		.scale 100
		.trans 0
		.rgbs 100, 100, 100, 100
		.font t[530], v[4511] .noShadow
		.spacing 0, 0
		.skin "" .nobg .noframe .noPadding
		.mapLayer 9
		.eraseWhenTransfer
		.affectedByFlash
		.affectedByShake
	    }
	    v[350] += 1
	    v[11] = v[857]
	    v[353] = v[157] + 33
	    v[354] += 11
	    v[355] = v[172] + (v[661] - 1) * 7 + 6
	    @pic[v[350]].strpic {
		"\t[\v[355]]"
		.pos v[353], v[354] .left
		.size 0, 0        .chromakey 1
		.scale 100
		.trans 0
		.rgbs 100, 100, 100, 100
		.font t[530], v[4511] .noShadow
		.spacing 0, 0
		.skin "" .nobg .noframe .noPadding
		.mapLayer 9
		.eraseWhenTransfer
		.affectedByFlash
		.affectedByShake
	    }
	    
	} .else bl {
	    @comment "##
	Show Equipment"
	    v[350] += 1
	    v[11] = v[851]
	    v[353] = v[157] + 38
	    v[354] = v[158] + 82
	    @call .cev 395
	    v[0] = v[542..548] = [v[350], v[350] + 1, v[350] + 2, v[350] + 3, v[350] + 4, v[350] + 5, v[350] + 6]
	    @pic[v[350]].strpic {
		"\t[503]"
		.pos v[353], v[354] .left
		.size 0, 0        .chromakey 1
		.scale 100
		.trans 0
		.rgbs 100, 100, 100, 100
		.font t[530], v[4511] .noShadow
		.spacing 0, 0
		.skin "" .nobg .noframe .noPadding
		.mapLayer 9
		.eraseWhenTransfer
		.affectedByFlash
		.affectedByShake
	    }
	    v[350] += 1
	    v[11] = v[852]
	    v[353] = v[157] + 38
	    v[354] += 11
	    @call .cev 396
	    @pic[v[350]].strpic {
		"\t[503]"
		.pos v[353], v[354] .left
		.size 0, 0        .chromakey 1
		.scale 100
		.trans 0
		.rgbs 100, 100, 100, 100
		.font t[530], v[4511] .noShadow
		.spacing 0, 0
		.skin "" .nobg .noframe .noPadding
		.mapLayer 9
		.eraseWhenTransfer
		.affectedByFlash
		.affectedByShake
	    }
	    v[350] += 1
	    v[11] = v[853]
	    v[353] = v[157] + 33
	    v[354] += 11
	    @call .cev 397
	    @pic[v[350]].strpic {
		"\t[503]"
		.pos v[353], v[354] .left
		.size 0, 0        .chromakey 1
		.scale 100
		.trans 0
		.rgbs 100, 100, 100, 100
		.font t[530], v[4511] .noShadow
		.spacing 0, 0
		.skin "" .nobg .noframe .noPadding
		.mapLayer 9
		.eraseWhenTransfer
		.affectedByFlash
		.affectedByShake
	    }
	    v[350] += 1
	    v[11] = v[854]
	    v[353] = v[157] + 28
	    v[354] += 11
	    @call .cev 398
	    @pic[v[350]].strpic {
		"\t[503]"
		.pos v[353], v[354] .left
		.size 0, 0        .chromakey 1
		.scale 100
		.trans 0
		.rgbs 100, 100, 100, 100
		.font t[530], v[4511] .noShadow
		.spacing 0, 0
		.skin "" .nobg .noframe .noPadding
		.mapLayer 9
		.eraseWhenTransfer
		.affectedByFlash
		.affectedByShake
	    }
	    v[350] += 1
	    v[11] = v[855]
	    v[353] = v[157] + 28
	    v[354] += 11
	    @call .cev 399
	    @pic[v[350]].strpic {
		"\t[503]"
		.pos v[353], v[354] .left
		.size 0, 0        .chromakey 1
		.scale 100
		.trans 0
		.rgbs 100, 100, 100, 100
		.font t[530], v[4511] .noShadow
		.spacing 0, 0
		.skin "" .nobg .noframe .noPadding
		.mapLayer 9
		.eraseWhenTransfer
		.affectedByFlash
		.affectedByShake
	    }
	    v[350] += 1
	    v[11] = v[856]
	    v[353] = v[157] + 33
	    v[354] += 11
	    @call .cev 395
	    @pic[v[350]].strpic {
		"\t[503]"
		.pos v[353], v[354] .left
		.size 0, 0        .chromakey 1
		.scale 100
		.trans 0
		.rgbs 100, 100, 100, 100
		.font t[530], v[4511] .noShadow
		.spacing 0, 0
		.skin "" .nobg .noframe .noPadding
		.mapLayer 9
		.eraseWhenTransfer
		.affectedByFlash
		.affectedByShake
	    }
	    v[350] += 1
	    v[11] = v[857]
	    v[353] = v[157] + 33
	    v[354] += 11
	    @call .cev 396
	    @pic[v[350]].strpic {
		"\t[503]"
		.pos v[353], v[354] .left
		.size 0, 0        .chromakey 1
		.scale 100
		.trans 0
		.rgbs 100, 100, 100, 100
		.font t[530], v[4511] .noShadow
		.spacing 0, 0
		.skin "" .nobg .noframe .noPadding
		.mapLayer 9
		.eraseWhenTransfer
		.affectedByFlash
		.affectedByShake
	    }
	    @comment "Equipment end
##"
	    
	}
	@comment "Equipment end
##"
	v[350] += 1
	@comment "Temp34
	Top Text Saved"
	v[541] = v[350]
	v[1251] = 4
	v[1252] = 0
	v[353] = v[157] + v[1251]
	v[354] = v[158] + v[1252]
	@pic[v[350]].strpic {
	    ""
	    .pos v[353], v[354] .left
	    .size 0, 0    .chromakey 1
	    .scale 100
	    .trans 0
	    .rgbs 100, 100, 100, 100
	    .font "misaki_gothic", 10
	    .spacing 0, 0
	    .skin "" .nobg .noframe .noPadding
	    .mapLayer 9
	    .eraseWhenTransfer
	    .affectedByFlash
	    .affectedByShake
	}
	v[350] += 1
	v[550] = v[350]
	@comment "Inventory"
	@if v[175] == 0 {
	    @comment "Show Pages"
	    v[350] += 1
	    v[2457] = v[176] / v[1247]
	    v[2457] += 1
	    v[1951] = 1 + v[550]
	    @pic[v[1951]].strpic {
		"\v[2457]/\v[2458]"
		.pos v[1249], v[1250] .center
		.size 0, 0        .chromakey 1
		.scale 100
		.trans 0
		.rgbs 100, 100, 100, 100
		.font "PixelMplus10-Regular", 12
		.spacing 0, 0
		.skin "" .nobg .noframe .noPadding
		.mapLayer 9
		.eraseWhenTransfer
		.affectedByFlash
		.affectedByShake
	    }
	    @comment "#Show Amount of Stash"
	    v[350] += 1
	    @pic[v[350]].strpic {
		"$P \v[2456]/\v[2460]"
		.pos v[1253], v[1254] .topRight
		.size 0, 0        .chromakey 1
		.scale 100
		.trans 0
		.rgbs 100, 100, 100, 100
		.font "PixelMplus10-Regular", 10
		.spacing 0, 0
		.skin "" .nobg .noframe .noPadding
		.mapLayer 9
		.eraseWhenTransfer
		.affectedByFlash
		.affectedByShake
	    }
	    @comment "Sort Button"
	    v[350] += 1
	    v[354] = v[157] + 294
	    v[355] = v[158] + 220
	    v[552] = v[350]
	    v[356] = v[174] + 2
	    @pic[v[350]].show {
		"ui\Inventory_Item_Sorts_Button"
		.pos v[354], v[355] .topLeft
		.chromakey 0
		.scale 100
		.trans 0
		.rgbs 100, 100, 100, 100
		.grid 1, 8 .cell v[356]
		.mapLayer 9
		.affectedByShake
	    }
	    v[350] += 1
	    @pic[v[350]].show {
		"ui\Inventory_Item_Sorts_Button2"
		.pos v[354], v[355] .topLeft
		.chromakey 0
		.scale 100
		.trans 100
		.rgbs 100, 100, 100, 100
		.grid 1, 8 .cell v[356]
		.mapLayer 9
		.affectedByShake
	    }
	    
	} .else bl {
	    @if v[175] == 2 {
		@comment "Show Invested Perk Points"
		v[350] += 1
		v[354] = v[1253] - 240
		v[355] = v[1254]
		v[356] = v[(v[173] - 1) * 300 + v[1261] - 1 + 151 + v[248]]
		@pic[v[350]].strpic {
		    "Invested Pt. \v[356]"
		    .pos v[354], v[355] .topLeft
		    .size 0, 0            .chromakey 1
		    .scale 100
		    .trans 0
		    .rgbs 100, 100, 100, 100
		    .font "PixelMplus10-Regular", 10
		    .spacing 0, 0
		    .skin "" .nobg .noframe .noPadding
		    .mapLayer 9
		    .eraseWhenTransfer
		    .affectedByFlash
		    .affectedByShake
		}
		@comment "#Show Remaining Perk Points"
		v[350] += 1
		v[356] = v[(v[173] - 1) * 300 + v[1261] - 1 + 91]
		@pic[v[350]].strpic {
		    "Perk Pt. \v[356]"
		    .pos v[1253], v[1254] .topRight
		    .size 0, 0            .chromakey 1
		    .scale 100
		    .trans 0
		    .rgbs 100, 100, 100, 100
		    .font "PixelMplus10-Regular", 10
		    .spacing 0, 0
		    .skin "" .nobg .noframe .noPadding
		    .mapLayer 9
		    .eraseWhenTransfer
		    .affectedByFlash
		    .affectedByShake
		}
		@comment "Sort Button"
		v[350] += 1
		v[354] = v[157] + 294
		v[355] = v[158] + 220
		v[552] = v[350]
		v[356] = v[174] + 2
		@pic[v[350]].show {
		    "ui\Inventory_Item_Sorts_Button"
		    .pos v[354], v[355] .topLeft
		    .chromakey 0
		    .scale 100
		    .trans 0
		    .rgbs 100, 100, 100, 100
		    .grid 1, 8 .cell v[356]
		    .mapLayer 9
		    .affectedByShake
		}
		v[350] += 1
		@pic[v[350]].show {
		    "ui\Inventory_Item_Sorts_Button2"
		    .pos v[354], v[355] .topLeft
		    .chromakey 0
		    .scale 100
		    .trans 100
		    .rgbs 100, 100, 100, 100
		    .grid 1, 8 .cell v[356]
		    .mapLayer 9
		    .affectedByShake
		}
		
	    } .else bl {
		v[350] += 1
		v[350] += 1
		v[350] += 1
		v[350] += 1
		
	    }
	    
	}
	@comment "#
	Button"
	v[350] += 1
	v[354] = v[157] + 220
	v[355] = v[158] + 18
	v[356] = v[175] + 2
	v[356] = v[175] == -1 ? 8 : v[356]
	v[551] = v[350]
	@pic[v[350]].show {
	    "ui\Inventory_Item_Skills_Perks_Button"
	    .pos v[354], v[355] .topLeft
	    .chromakey 0
	    .scale 100
	    .trans 0
	    .rgbs 100, 100, 100, 100
	    .grid 1, 8 .cell v[356]
	    .mapLayer 9
	    .affectedByShake
	}
	v[350] += 1
	@pic[v[350]].show {
	    "ui\Inventory_Item_Skills_Perks_Button"
	    .pos v[354], v[355] .topLeft
	    .chromakey 1
	    .scale 100
	    .trans 100
	    .rgbs 100, 100, 100, 100
	    .grid 1, 8 .cell 1
	    .mapLayer 9
	    .affectedByShake
	}
	@comment "LvUp"
	v[350] += 1
	v[554] = v[350]
	v[354] = v[157] + 108
	v[355] = v[158] + 54
	v[356] = v[(v[173] - 1) * 300 + v[1261] + 91] > 0 && v[175] >= 0 ? 0 : 100
	@pic[v[350]].show {
	    "ui\icon_can_lvUp"
	    .pos v[354], v[355] .center
	    .chromakey 1
	    .scale 100
	    .trans v[356]
	    .rgbs 100, 100, 100, 100
	    .mapLayer 9
	    .affectedByShake
	}
	@comment "End#"
	@loop .inf() {
	    get_selected_agent_data()
	    @key.input .dst v[43] {
		.decision
		.number
		.lclick
		.rclick
		.wheelDown
		.wheelUp
	    }
	    @key.inputEx .keyCode 27 .dst v[1222]
	    @key.input .dst v[45] {
		.number
		.symbol
	    }
	    @if v[1222] == 1 {
		@break
		
	    }
	    v[84..84] = 0
	    s[201].off
	    @comment "Inv Loop"
	    @comment "This part causes picture bug in RTS game mode"
	    @if v[175] >= 0 {
		@comment "Companions"
		@loop v[1192] .dst v[343] {
		    v[330] = v[343]
		    @comment "CompanionsIndex is not yet completed"
		    v[329] = v[1263] + v[343] + v[153]
		    @if v[v[329]] < 999999999 {
			v[343] = v[v[329]] % v[1264] - 1
			v[1951] = 1600 + v[330] * 8
			v[371] = v[343] + 1 != v[256] ? 4 : 0
			@if v[371] == 4 {
			    @pic[v[1951]].getInfo .cewh .currentRect v[1952], v[1953], v[1954], v[1954]
			    v[371] = between(v[51], v[1952] - 11, v[1952] + 11) && between(v[52], v[1953] - 14, v[1953] + 14) && 90 < v[51] ? 4 : 0
			    @if v[371] == 4 {
				v[84] = v[343] + 10
				@loop 6 .dst v[11] {
				    v[11] = v[1951] + v[11]
				    @pic[v[11]].move {
					.pos v[1952], v[1953] .center
					.scale 100
					.trans 0
					.time -2
					.rgbs 80, 80, 80, 80
				    }
				    
				}
				
				s[201].on
				@if v[84] != v[85] {
				    v[1957] = v[343] * 5 + v[1262]
				    v[1958] = v[v[343] * 300 + v[1261]] == 3 ? 1 : 2
				    v[353] = v[157] + v[1251]
				    v[354] = v[158] + v[1252]
				    @pic[v[541]].strpic {
					"\c[\v[1958]]\t[\v[1957]]\c[0]　\t[20053]"
					.pos v[353], v[354] .left
					.size 0, 0                                .chromakey 1
					.scale 100
					.trans 0
					.rgbs 100, 100, 100, 100
					.font "misaki_gothic", 10
					.spacing 0, 0
					.skin "" .nobg .noframe .noPadding
					.mapLayer 9
					.eraseWhenTransfer
					.affectedByFlash
					.affectedByShake
				    }
				    
				}
				@comment "Num Key"
				@key.input .dst v[45] {
				    .number
				}
				@if v[45] >= 10 {
				    @if v[46] == 0 {
					v[46] += 1
					@se.play "cursor09" .opt 80, 90, 50
					v[45] -= 10
					v[45] += v[45] == 0 ? 10 : 0
					v[v[343] * 300 + v[1261] + 79] = v[45]
					@call .cev 1946
					
				    }
				    
				} .else bl {
				    v[46] = 0
				    
				}
				@if v[43] == 1006 {
				    @if s[13] .isOff() {
					s[13].on
					@comment "#Dismiss"
					@comment "ALT?"
					@key.inputEx .keyCode 18 .dst v[14]
					@if v[14] >= 1 {
					    v[14] = (v[v[343] * 300 + v[1261] + 9] & 1) != 1 ? 1 : 0
					    @if v[14] >= 1 {
						@se.play "cursor19" .opt 80, 70, 50
						v[12] = v[343] + 1
						v[19] = v[1187]
						@call .cev 1979
						v[84..85] = 0
						@pic[v[555]..v[556]].erase
						@label.jump 10
						
					    } .else bl {
						@comment "Locked"
						@se.play "cursor07" .opt 50, 80, 50
						v[353] = v[157] + v[1251]
						v[354] = v[158] + v[1252]
						@pic[v[541]].strpic {
						    "\t[20044]"
						    .pos v[353], v[354] .left
						    .size 0, 0                                            .chromakey 1
						    .scale 100
						    .trans 0
						    .rgbs 100, 100, 100, 100
						    .font "misaki_gothic", 10
						    .spacing 0, 0
						    .skin "" .nobg .noframe .noPadding
						    .mapLayer 9
						    .eraseWhenTransfer
						    .affectedByFlash
						    .affectedByShake
						}
						v[85] = v[84]
						
					    }
					    
					}
					
				    }
				    
				}
				@if v[43] == 1005 {
				    @if s[11] .isOff() {
					@se.play "Key" .opt 80, 80, 50
					v[256] = v[343] + 1
					v[84..85] = 0
					s[11].on
					@pic[v[555]..v[556]].erase
					@label.jump 10
					
				    }
				    
				}
				
			    } .else bl {
				@loop 6 .dst v[11] {
				    v[11] = v[1951] + v[11]
				    @pic[v[11]].move {
					.pos v[1952], v[1953] .center
					.scale 100
					.trans 0
					.time -2
					.rgbs 60, 60, 60, 60
				    }
				    
				}
				
				
			    }
			    
			} .else bl {
			    
			}
			
		    } .else bl {
			@break
			
		    }
		    
		}
		
		
	    }
	    @comment "Close"
	    @if v[909] >= 1 {
		@if v[959] == 0 {
		    v[959] += 4
		    @break
		    
		}
		
	    } .else bl {
		v[959] = 0
		
	    }
	    v[371] = between(v[51], v[157] + 551 - 84 - 3, v[157] + 551 - 84 + 11) && between(v[52], v[158] - 10 - 3, v[158] - 10 + 11) ? 4 : 0
	    @if v[371] == 4 {
		@if v[43] == 1005 {
		    @if s[11] .isOff() {
			@break
			
		    }
		    
		}
		
	    }
	    @if v[175] >= 0 {
		@comment "Menu Button"
		v[314] = v[551] + 1
		@pic[v[551]].getInfo .ltrb .baseRect v[354], v[355], v[348], v[348]
		@pic[v[314]].show {
		    "ui\Inventory_Item_Skills_Perks_Button"
		    .pos v[354], v[355] .topLeft
		    .chromakey 1
		    .scale 100
		    .trans 100
		    .rgbs 100, 100, 100, 100
		    .grid 1, 8 .cell 1
		    .mapLayer 9
		    .eraseWhenTransfer
		    .affectedByFlash
		    .affectedByShake
		}
		@comment "#Items"
		v[312] = v[157] + 234
		v[313] = v[158] + 19
		v[371] = between(v[51], v[312], v[312] + 72) && between(v[52], v[313], v[313] + 18) ? 4 : 0
		@if v[371] == 4 {
		    @pic[v[314]].show {
			"ui\Inventory_Item_Skills_Perks_Button"
			.pos v[354], v[355] .topLeft
			.chromakey 1
			.scale 100
			.trans 0
			.rgbs 100, 100, 100, 100
			.grid 1, 8 .cell 5
			.mapLayer 9
			.eraseWhenTransfer
			.affectedByFlash
			.affectedByShake
		    }
		    @if v[43] == 1005 {
			@if s[11] .isOff() {
			    @se.play "click1" .opt 80, 100, 50
			    @comment "Mouse wheel down"
			    v[175] = 0
			    s[11].on
			    @label.jump 10
			    
			}
			
		    }
		    
		}
		@comment "#Skills"
		v[312] += 75
		v[371] = between(v[51], v[312], v[312] + 72) && between(v[52], v[313], v[313] + 18) ? 4 : 0
		@if v[371] == 4 {
		    @pic[v[314]].show {
			"ui\Inventory_Item_Skills_Perks_Button"
			.pos v[354], v[355] .topLeft
			.chromakey 1
			.scale 100
			.trans 0
			.rgbs 100, 100, 100, 100
			.grid 1, 8 .cell 6
			.mapLayer 9
			.eraseWhenTransfer
			.affectedByFlash
			.affectedByShake
		    }
		    @if v[43] == 1005 {
			@if s[11] .isOff() {
			    @se.play "click1" .opt 80, 100, 50
			    @comment "Mouse wheel down"
			    v[176] -= 16
			    @if v[176] < 0 {
				v[341] = v[2459] / v[1247]
				v[176] = v[341] * v[1247]
				
			    }
			    @call .cev 1950
			    s[11].on
			    
			}
			
		    }
		    
		}
		@comment "#Perks"
		v[312] += 75
		v[371] = between(v[51], v[312], v[312] + 72) && between(v[52], v[313], v[313] + 18) ? 4 : 0
		@if v[371] == 4 {
		    @pic[v[314]].show {
			"ui\Inventory_Item_Skills_Perks_Button"
			.pos v[354], v[355] .topLeft
			.chromakey 1
			.scale 100
			.trans 0
			.rgbs 100, 100, 100, 100
			.grid 1, 8 .cell 7
			.mapLayer 9
			.eraseWhenTransfer
			.affectedByFlash
			.affectedByShake
		    }
		    @if v[43] == 1005 {
			@if s[11] .isOff() {
			    @se.play "click1" .opt 80, 100, 50
			    v[175] = 2
			    s[11].on
			    @label.jump 10
			    
			}
			
		    }
		    
		}
		
	    }
	    @comment "Inventory"
	    @if v[175] == 0 {
		@comment "Sort Button"
		v[314] = v[552] + 1
		@pic[v[552]].getInfo .ltrb .baseRect v[354], v[355], v[348], v[348]
		@pic[v[314]].show {
		    "ui\Inventory_Item_Sorts_Button2"
		    .pos v[354], v[355] .topLeft
		    .chromakey 0
		    .scale 100
		    .trans 100
		    .rgbs 100, 100, 100, 100
		    .grid 1, 8 .cell v[356]
		    .mapLayer 9
		    .affectedByShake
		}
		@comment "#Items"
		v[312] = v[157] + 294
		v[313] = v[158] + 220
		v[371] = between(v[51], v[312], v[312] + 15 * 6) && between(v[52], v[313], v[313] + 15) ? 4 : 0
		@if v[371] == 4 {
		    v[316] = (v[51] - v[312]) / 15
		    v[315] = 2 + v[316]
		    @pic[v[314]].show {
			"ui\Inventory_Item_Sorts_Button2"
			.pos v[354], v[355] .topLeft
			.chromakey 1
			.scale 100
			.trans 0
			.rgbs 100, 100, 100, 100
			.grid 1, 8 .cell v[315]
			.mapLayer 9
			.eraseWhenTransfer
			.affectedByFlash
			.affectedByShake
		    }
		    @if v[43] == 1005 {
			@if s[11] .isOff() {
			    @se.play "click1" .opt 80, 100, 50
			    v[341] = v[316] + 1951
			    @call .cev v[341]
			    @comment "#Reload sort button"
			    v[354] = v[157] + 294
			    v[355] = v[158] + 220
			    v[356] = v[174] + 2
			    @pic[v[552]].show {
				"ui\Inventory_Item_Sorts_Button"
				.pos v[354], v[355] .topLeft
				.chromakey 0
				.scale 100
				.trans 0
				.rgbs 100, 100, 100, 100
				.grid 1, 8 .cell v[356]
				.mapLayer 9
				.affectedByShake
			    }
			    v[176] = 0
			    @call .cev 1950
			    s[11].on
			    
			}
			
		    }
		    
		}
		@comment "Page Button"
		v[1249] = 524
		v[1250] = 220
		@pic[v[550]].show {
		    "ui\shittytriangle"
		    .pos v[1249], v[1250] .center
		    .chromakey 1
		    .scale 100
		    .trans 0
		    .rgbs 100, 100, 100, 100
		    .grid 1, 3 .cell 1
		    .mapLayer 9
		    .eraseWhenTransfer
		    .affectedByFlash
		    .affectedByShake
		}
		@comment "#ButtonL"
		v[371] = between(v[51], v[1249] - 28, v[1249] - 8) && between(v[52], v[1250] - 12, v[1250] + 12) ? 4 : 0
		@if v[371] == 4 {
		    @pic[v[550]].show {
			"ui\shittytriangle"
			.pos v[1249], v[1250] .center
			.chromakey 1
			.scale 100
			.trans 0
			.rgbs 100, 100, 100, 100
			.grid 1, 3 .cell 3
			.mapLayer 9
			.eraseWhenTransfer
			.affectedByFlash
			.affectedByShake
		    }
		    @if v[43] == 1005 {
			@if s[11] .isOff() {
			    @se.play "click1" .opt 80, 100, 50
			    @comment "Mouse wheel down"
			    v[176] -= 16
			    @if v[176] < 0 {
				v[341] = (v[2459] - 1) / v[1247]
				v[176] = v[341] * v[1247]
				
			    }
			    @call .cev 1950
			    s[11].on
			    
			}
			
		    }
		    
		}
		@comment "#ButtonR"
		v[371] = between(v[51], v[1249] + 8, v[1249] + 28) && between(v[52], v[1250] - 12, v[1250] + 12) ? 4 : 0
		@if v[371] == 4 {
		    @pic[v[550]].show {
			"ui\shittytriangle"
			.pos v[1249], v[1250] .center
			.chromakey 1
			.scale 100
			.trans 0
			.rgbs 100, 100, 100, 100
			.grid 1, 3 .cell 2
			.mapLayer 9
			.eraseWhenTransfer
			.affectedByFlash
			.affectedByShake
		    }
		    @if v[43] == 1005 {
			@if s[11] .isOff() {
			    @se.play "click1" .opt 80, 100, 50
			    v[176] += 16
			    @if v[176] >= v[2459] {
				v[176] = 0
				
			    }
			    @call .cev 1950
			    s[11].on
			    
			}
			
		    }
		    
		}
		@comment "Right Side"
		@loop v[1247] .dst v[343] {
		    v[371] = between(v[51], v[1243], v[1243] + v[1241]) && between(v[52], v[1244] + v[1245] * v[343], v[1244] + v[1242] + v[1245] * v[343]) ? 4 : 0
		    v[1951] = 1233 + v[343]
		    v[1959] = v[1951] + v[1247]
		    @pic[v[1951]].getInfo .cewh .currentRect v[1952], v[1953], v[1954], v[1954]
		    @if v[371] == 4 {
			v[84] = v[343] + 10
			@pic[v[1951]].move {
			    .pos v[1952], v[1953] .center
			    .scale 100
			    .trans 0
			    .time -2
			    .rgbs 0, 200, 0, 100
			}
			@pic[v[1959]].getInfo .cewh .currentRect v[1952], v[1953], v[1954], v[1954]
			v[353] = 135 + sin(v[2219] * 15, 2, 28)
			v[354] = 100
			@pic[v[1959]].move {
			    .pos v[1952], v[1953] .center
			    .scale 100
			    .trans 0
			    .time -2
			    .rgbs v[353], v[353], v[353], v[354]
			}
			s[201].on
			v[1951] = v[1246] + v[343]
			@comment "Is there Valid Item?"
			@if v[v[1951]] > 0 {
			    @if v[84] != v[85] {
				v[84..85] = v[343] + 10
				v[1951] = v[1187] + v[v[1951]] * 40 + 39 - 40
				v[11] = v[v[1951]]
				@if v[11] >= 1 {
				    v[15] = v[v[1951] - 11]
				    v[1952] = v[1150] + v[15] - 1
				    @call .cev v[1952]
				    v[1943] = v[1903] + 100
				    v[1944] = v[1908] / 1000
				    @if s[58] .isOn() {
					@call .cev 1932
					
				    }
				    v[353] = v[157] + v[1251]
				    v[354] = v[158] + v[1252]
				    @pic[v[541]].strpic {
					"\t[20048]"
					.pos v[353], v[354] .left
					.size 0, 0                                .chromakey 1
					.scale 100
					.trans 0
					.rgbs 100, 100, 100, 100
					.font "misaki_gothic", 10
					.spacing 0, 0
					.skin "" .nobg .noframe .noPadding
					.mapLayer 9
					.eraseWhenTransfer
					.affectedByFlash
					.affectedByShake
				    }
				    
				} .else bl {
				    
				}
				
			    }
			    @if v[43] == 1006 {
				v[1951] = v[1246] + v[343]
				v[1951] = v[1187] + v[v[1951]] * 40 + 28 - 40
				v[1951] = pow(2, v[v[1951]] - 1) & v[v[284] + 250]
				@if s[13] .isOff() {
				    @if v[1951] == 0 {
					v[1951] = v[v[1246] + v[343]]
					v[1952] = v[1187] + (v[1951] - 1) * 40 + 28
					@comment "#########################"
					v[471] = 11550
					v[472] = divmul(90, 100, v[2216])
					v[473] = 100
					v[474] = 50
					@comment "#########################"
					v[329] = v[v[1952]]
					t[510] .asg "ui\equip_"
					t[510] .cat v[329]
					v[341] = 510
					@comment "Strings = t[v[341]]"
					@cmd 11550, t[v[341]], .args v[472], 3
					@comment "################"
					v[11] = v[1951]
					v[12] = v[173]
					@comment "setting into reserve is Underdev"
					v[13] = v[v[1952]]
					@key.inputEx .keyCode 17 .dst v[14]
					v[19] = v[1187]
					@call .cev 1961
					@if s[20] .isOff() {
					    @call .cev 1948
					    
					}
					v[341] = v[174] + 1951
					@call .cev v[341]
					@call .cev 1950
					@call .cev 1949
					@call .cev 1946
					v[84..85] = 0
					
				    } .else bl {
					@comment "Locked"
					@se.play "cursor07" .opt 50, 80, 50
					v[353] = v[157] + v[1251]
					v[354] = v[158] + v[1252]
					@pic[v[541]].strpic {
					    "\t[20039]"
					    .pos v[353], v[354] .left
					    .size 0, 0                                    .chromakey 1
					    .scale 100
					    .trans 0
					    .rgbs 100, 100, 100, 100
					    .font "misaki_gothic", 10
					    .spacing 0, 0
					    .skin "" .nobg .noframe .noPadding
					    .mapLayer 9
					    .eraseWhenTransfer
					    .affectedByFlash
					    .affectedByShake
					}
					
				    }
				    
				}
				
			    }
			    
			} .else bl {
			    s[201].off
			    
			}
			
		    } .else bl {
			@pic[v[1951]].move {
			    .pos v[1952], v[1953] .center
			    .scale 100
			    .trans 0
			    .time -2
			    .rgbs 100, 100, 100, 100
			}
			@pic[v[1959]].getInfo .cewh .currentRect v[1952], v[1953], v[1954], v[1954]
			@pic[v[1959]].move {
			    .pos v[1952], v[1953] .center
			    .scale 100
			    .trans 0
			    .time -2
			    .rgbs 100, 100, 100, 100
			}
			
		    }
		    
		}
		
		@comment "Mouse wheel up"
		@if v[43] == 1004 {
		    v[176] += 16
		    @if v[176] >= v[2459] {
			v[176] = 0
			
		    }
		    @call .cev 1950
		    
		}
		@comment "Mouse wheel down"
		@if v[43] == 1001 {
		    v[176] -= 16
		    @if v[176] < 0 {
			v[341] = (v[2459] - 1) / v[1247]
			v[176] = v[341] * v[1247]
			
		    }
		    @call .cev 1950
		    
		}
		
	    } .else bl {
		@comment "Perk Menu"
		@if `v[175] == 2 || v[175] == -1 {
		    @if v[175] != -1 {
			@comment "Sort Button"
			v[314] = v[552] + 1
			@pic[v[552]].getInfo .ltrb .baseRect v[354], v[355], v[348], v[348]
			@pic[v[314]].show {
			    "ui\Inventory_Item_Sorts_Button2"
			    .pos v[354], v[355] .topLeft
			    .chromakey 0
			    .scale 100
			    .trans 100
			    .rgbs 100, 100, 100, 100
			    .grid 1, 8 .cell v[356]
			    .mapLayer 9
			    .affectedByShake
			}
			
		    }
		    @comment "PERK ICONZ"
		    @comment "Right Side"
		    @pic[1601].show {
			"ui\PerkSquare"
			.pos v[354], v[355] .topLeft
			.chromakey 1
			.scale 100
			.trans 100
			.rgbs 100, 100, 100, 100
			.mapLayer 9
			.affectedByShake
		    }
		    @loop 100 .dst v[330] {
			v[1951] = 1500 + v[330]
			@pic[v[1951]].getInfo .cewh .currentRect v[1952], v[1953], v[1954], v[1955]
			v[371] = between(v[51], v[1952] - v[1954] / 2, v[1952] + v[1954] / 2) && between(v[52], v[1953] - v[1955] / 2, v[1953] + v[1955] / 2) ? 4 : 0
			@if v[371] == 4 {
			    @pic[1601].show {
				"ui\PerkSquare"
				.pos v[1952], v[1953] .center
				.chromakey 1
				.scale 100
				.trans 15
				.rgbs 100, 100, 100, 100
				.mapLayer 9
				.affectedByShake
			    }
			    s[201].on
			    @comment "Is there Valid Perk?"
			    v[11] = v[173]
			    v[12] = v[330] + 1
			    @call .cev 1991
			    v[84] = v[330] + 1000
			    @if v[21] > -1 {
				@if v[84] != v[85] {
				    v[84..85] = v[330] + 1000
				    v[51].copy v[353], 2
				    v[353] -= 16
				    @call .cev 1992
				    v[353] = v[157] + v[1251]
				    v[354] = v[158] + v[1252]
				    @if v[175] != -1 {
					@if v[21] == 2 {
					    @pic[v[541]].strpic {
						"\c[2]\t[20041]"
						.pos v[353], v[354] .left
						.size 0, 0                                        .chromakey 1
						.scale 100
						.trans 0
						.rgbs 100, 100, 100, 100
						.font "misaki_gothic", 10
						.spacing 0, 0
						.skin "" .nobg .noframe .noPadding
						.mapLayer 9
						.eraseWhenTransfer
						.affectedByFlash
						.affectedByShake
					    }
					    
					} .else bl {
					    @if v[21] == 1 {
						@pic[v[541]].strpic {
						    "\t[20042]"
						    .pos v[353], v[354] .left
						    .size 0, 0                                            .chromakey 1
						    .scale 100
						    .trans 0
						    .rgbs 100, 100, 100, 100
						    .font "misaki_gothic", 10
						    .spacing 0, 0
						    .skin "" .nobg .noframe .noPadding
						    .mapLayer 9
						    .eraseWhenTransfer
						    .affectedByFlash
						    .affectedByShake
						}
						
					    } .else bl {
						@pic[v[541]].strpic {
						    "\c[17]\t[20043]"
						    .pos v[353], v[354] .left
						    .size 0, 0                                            .chromakey 1
						    .scale 100
						    .trans 0
						    .rgbs 100, 100, 100, 100
						    .font "misaki_gothic", 10
						    .spacing 0, 0
						    .skin "" .nobg .noframe .noPadding
						    .mapLayer 9
						    .eraseWhenTransfer
						    .affectedByFlash
						    .affectedByShake
						}
						
					    }
					    
					}
					
				    }
				    
				}
				
			    }
			    @if v[175] != -1 {
				@if v[43] == 1005 {
				    @if s[11] .isOff() {
					@if v[21] == 1 {
					    @comment "#########################"
					    v[471] = 11550
					    v[472] = divmul(70, 100, v[2216])
					    v[473] = 100
					    v[474] = 50
					    @comment "#########################"
					    @cmd v[471], "ui\UI_Quirky_39", .args v[472], 3
					    @comment "#########################"
					    v[353] = v[157] + v[1251]
					    v[354] = v[158] + v[1252]
					    @pic[v[541]].strpic {
						"\t[20040]"
						.pos v[353], v[354] .left
						.size 0, 0                                        .chromakey 1
						.scale 100
						.trans 0
						.rgbs 100, 100, 100, 100
						.font "misaki_gothic", 10
						.spacing 0, 0
						.skin "" .nobg .noframe .noPadding
						.mapLayer 9
						.eraseWhenTransfer
						.affectedByFlash
						.affectedByShake
					    }
					    @comment "TT12=Points"
					    v[352] = 3
					    @comment "TT13=Flag"
					    v[353] = 0
					    @comment "Pic"
					    v[347] = 1700
					    v[348] = v[347]
					    v[345] = v[1115]
					    v[346] = v[1116] - 24
					    v[350] = (v[173] - 1) * 300 + v[1261] + 100
					    v[v[350]].copy v[701], 40
					    @pic[v[347]].strpic {
						""
						.pos v[345], v[346] .center
						.size 196, 80                                        .chromakey 1
						.scale 100
						.trans 0
						.rgbs 100, 100, 100, 100
						.font "misaki_gothic", 11
						.spacing 0, 0
						.skin "SystemWindow" .stretch
						.mapLayer 9
						.eraseWhenTransfer
						.affectedByFlash
						.affectedByShake
					    }
					    @pic[v[347]].getInfo .ltrb .currentRect v[1952], v[1953], v[1954], v[1955]
					    v[347] += 1
					    v[345] = v[1952] + 48
					    v[346] = v[1953] + 52
					    @pic[v[347]].strpic {
						"  \t[20036] "
						.pos v[345], v[346] .center
						.size 0, 0                                        .chromakey 1
						.scale 100
						.trans 50
						.rgbs 100, 100, 100, 100
						.font "misaki_gothic", 11 .noShadow
						.spacing 0, 0
						.skin "SystemSwitch" .nobg .noGradation
						.mapLayer 9
						.eraseWhenTransfer
						.affectedByFlash
						.affectedByShake
					    }
					    v[347] += 1
					    v[345] += 84
					    @pic[v[347]].strpic {
						"\t[20037]"
						.pos v[345], v[346] .center
						.size 0, 0                                        .chromakey 1
						.scale 100
						.trans 0
						.rgbs 100, 100, 100, 100
						.font "misaki_gothic", 11 .noShadow
						.spacing 0, 0
						.skin "SystemSwitch" .nobg .noGradation
						.mapLayer 9
						.eraseWhenTransfer
						.affectedByFlash
						.affectedByShake
					    }
					    v[345] = v[1952] + 142
					    v[346] = v[1953] + 15
					    v[347] += 1
					    v[345] = v[1952] + 98
					    v[346] = v[1953] + 6
					    @pic[v[347]].strpic {
						"\t[20038]"
						.pos v[345], v[346] .top
						.size 0, 0                                        .chromakey 1
						.scale 100
						.trans 0
						.rgbs 100, 100, 100, 100
						.font "misaki_gothic", 11 .noShadow
						.spacing 0, 0
						.skin "SystemSwitch" .nobg .noframe .noGradation .noPadding
						.mapLayer 9
						.eraseWhenTransfer
						.affectedByFlash
						.affectedByShake
					    }
					    v[347] += 1
					    v[346] += 14
					    @pic[v[347]].strpic {
						"\c[5]\t[503]"
						.pos v[345], v[346] .top
						.size 0, 0                                        .chromakey 1
						.scale 100
						.trans 0
						.rgbs 100, 100, 100, 100
						.font "misaki_gothic", 11 .noShadow
						.spacing 0, 0
						.skin "SystemSwitch" .nobg .noframe .noGradation .noPadding
						.mapLayer 9
						.eraseWhenTransfer
						.affectedByFlash
						.affectedByShake
					    }
					    v[349] = v[347]
					    v[353] = v[1115] - 98
					    v[354] = v[1116] - 24
					    @call .cev 1992
					    @loop .inf() {
						@key.input .dst v[43] {
						    .lclick
						    .rclick
						}
						@key.inputEx .keyCode 27 .dst v[1222]
						@key.input .dst v[45] {
						    .number
						    .symbol
						}
						@if v[1222] == 1 {
						    @break
						    
						}
						s[201].off
						@comment "Inv Loop"
						@comment "Close"
						v[371] = between(v[51], 551, 551 + 8) && between(v[52], 2, 2 + 8) ? 4 : 0
						@if v[371] == 4 {
						    @if v[43] == 1005 {
							@if s[11] .isOff() {
							    @break
							    
							}
							
						    }
						    
						}
						@comment "Done"
						v[347] = v[348] + 1
						@pic[v[347]].getInfo .cewh .currentRect v[1952], v[1953], v[1954], v[1955]
						v[371] = between(v[51], v[1952] - v[1954] / 2, v[1952] + v[1954] / 2) && between(v[52], v[1953] - v[1955] / 2, v[1953] + v[1955] / 2) ? 4 : 0
						@if v[371] == 4 {
						    @pic[v[347]].move {
							.pos v[1952], v[1953] .center
							.scale 100
							.trans 0
							.time -2
							.rgbs 0, 200, 0, 100
						    }
						    @if v[43] == 1005 {
							@if s[11] .isOff() {
							    s[11].on
							    @comment "#########################"
							    v[471] = 11550
							    v[472] = divmul(80, 100, v[2216])
							    v[473] = 100
							    v[474] = 50
							    @comment "#########################"
							    @cmd v[471], "ui\UI_Quirky_46", .args v[472], 3
							    @comment "#########################"
							    v[11] = v[173]
							    v[12] = v[330] + 1
							    @call .cev 1991
							    @comment "Spend Perk Points"
							    v[(v[173] - 1) * 300 + v[1261] - 1 + 91] -= 1
							    v[(v[173] - 1) * 300 + v[1261] - 1 + 151 + v[248]] += 1
							    v[(v[173] - 1) * 300 + v[1261] - 1 + 5 + v[24]] |= v[23]
							    @call .cev 1993
							    @break
							    
							}
							
						    }
						    
						} .else bl {
						    @pic[v[347]].move {
							.pos v[1952], v[1953] .center
							.scale 100
							.trans 0
							.time -2
							.rgbs 100, 100, 100, 100
						    }
						    
						}
						@comment "Cancel"
						v[347] = v[348] + 2
						@pic[v[347]].getInfo .cewh .currentRect v[1952], v[1953], v[1954], v[1955]
						v[371] = between(v[51], v[1952] - v[1954] / 2, v[1952] + v[1954] / 2) && between(v[52], v[1953] - v[1955] / 2, v[1953] + v[1955] / 2) ? 4 : 0
						@if v[371] == 4 {
						    @pic[v[347]].move {
							.pos v[1952], v[1953] .center
							.scale 100
							.trans 0
							.time -2
							.rgbs 0, 200, 0, 100
						    }
						    @if v[43] == 1005 {
							@if s[11] .isOff() {
							    s[11].on
							    @break
							    
							}
							
						    }
						    
						} .else bl {
						    @pic[v[347]].move {
							.pos v[1952], v[1953] .center
							.scale 100
							.trans 0
							.time -2
							.rgbs 100, 100, 100, 100
						    }
						    
						}
						@comment "Menu Button"
						@if s[201] .isOff() {
						    v[85..85] = 0
						    
						}
						@wait 0
						@if v[43] == 1005 {
						    @if s[11] .isOff() {
							
						    }
						    s[11].on
						    
						} .else bl {
						    s[11].off
						    
						}
						
					    }
					    
					    @pic[996].erase
					    @pic[v[541]].erase
					    @pic[v[348]..v[349]].erase
					    @label.jump 10
					    
					}
					
				    }
				    
				}
				
			    }
			    
			}
			
		    }
		    
		    
		} .else bl {
		    
		}
		
	    }
	    @comment "Left Side"
	    v[312] = v[157] + 4
	    v[313] = v[158] + 82
	    v[314] = 10
	    @if v[175] >= 0 {
		@comment "Talent"
		v[371] = between(v[51], v[312], v[312] + 110) && between(v[52], v[158] + 144, v[158] + 144 + 9) && between(v[(v[173] - 1) * 300 + v[1261] + 0], 1, 2) ? 4 : 0
		@if v[371] == 4 {
		    s[201].on
		    v[84] = 1001
		    @if v[84] != v[85] {
			@if s[58] .isOn() {
			    v[353] = v[51]
			    v[354] = v[52]
			    @call .cev 1945
			    
			}
			v[85] = 1001
			
		    }
		    
		}
		@comment "LvUp"
		@pic[v[554]].getInfo .cewh .currentRect v[1952], v[1953], v[1954], v[1954]
		v[371] = between(v[51], v[1952] - 16, v[1952] + 16) && between(v[52], v[1953] - 16, v[1953] + 16) && v[(v[173] - 1) * 300 + v[1261] + 91] > 0 ? 4 : 0
		@if v[371] == 4 {
		    s[201].on
		    v[84] = 1000
		    @if v[84] != v[85] {
			v[353] = v[157] + v[1251]
			v[354] = v[158] + v[1252]
			@pic[v[541]].strpic {
			    "\t[20052]"
			    .pos v[353], v[354] .left
			    .size 0, 0                    .chromakey 1
			    .scale 100
			    .trans 0
			    .rgbs 100, 100, 100, 100
			    .font "misaki_gothic", 10
			    .spacing 0, 0
			    .skin "" .nobg .noframe .noPadding
			    .mapLayer 9
			    .eraseWhenTransfer
			    .affectedByFlash
			    .affectedByShake
			}
			v[85] = 1000
			
		    }
		    @if v[43] == 1005 {
			@if s[11] .isOff() {
			    @call .cev 1947
			    
			}
			
		    }
		    
		}
		
	    }
	    @comment "Passive"
	    v[371] = between(v[51], v[157] + 46, v[157] + 78) && between(v[52], v[158] + 54 - 16, v[158] + 54 + 16) ? 4 : 0
	    @pic[v[553]].getInfo .cewh .currentRect v[1952], v[1953], v[1954], v[1954]
	    @if v[371] == 4 {
		s[201].on
		v[84] = v[175] >= 0 ? v[v[284] + 221] : v[821]
		@if v[84] != v[85] {
		    @if s[58] .isOn() {
			@comment "番号を見る"
			v[1942] = v[52] + 108
			v[1942].swap v[1065], 1
			v[301] = 821
			@call .cev 1100
			v[1942].swap v[1065], 1
			
		    }
		    v[85] = v[v[284] + 221]
		    
		}
		
	    }
	    @comment "Weapon"
	    v[371] = between(v[51], v[312], v[312] + 110) && between(v[52], v[313], v[313] + 11) ? 4 : 0
	    @pic[v[542]].getInfo .cewh .currentRect v[1952], v[1953], v[1954], v[1954]
	    @if v[371] == 4 {
		@pic[v[542]].move {
		    .pos v[1952], v[1953] .center
		    .scale 100
		    .trans 0
		    .time -2
		    .rgbs 0, 200, 0, 100
		}
		v[84] = 1
		s[201].on
		v[11] = v[851]
		@if v[11] >= 1 {
		    @if v[84] != v[85] {
			v[84..85] = 1
			@call .cev 395
			@if v[175] >= 0 {
			    v[12] = v[173]
			    v[13] = 1
			    v[19] = v[171]
			    @call .cev 1980
			    
			}
			v[1943] = v[1903] + 100
			v[1944] = v[1908] / 1000
			@if s[58] .isOn() {
			    v[15] = 1
			    @call .cev 1932
			    
			}
			@if v[v[175]] == 0 {
			    v[353] = v[157] + v[1251]
			    v[354] = v[158] + v[1252]
			    @pic[v[541]].strpic {
				"\t[20047]"
				.pos v[353], v[354] .left
				.size 0, 0                        .chromakey 1
				.scale 100
				.trans 0
				.rgbs 100, 100, 100, 100
				.font "misaki_gothic", 10
				.spacing 0, 0
				.skin "" .nobg .noframe .noPadding
				.mapLayer 9
				.eraseWhenTransfer
				.affectedByFlash
				.affectedByShake
			    }
			    
			}
			
		    }
		    @if v[175] >= 0 {
			@if v[43] == 1006 {
			    v[1951] = 1 & v[v[284] + 250]
			    @if s[13] .isOff() {
				v[13] = 1
				v[14] = 0
				@call .cev 1934
				
			    }
			    
			}
			
		    }
		    
		} .else bl {
		    s[201].off
		    
		}
		
	    } .else bl {
		@pic[v[542]].move {
		    .pos v[1952], v[1953] .center
		    .scale 100
		    .trans 0
		    .time -2
		    .rgbs 100, 100, 100, 100
		}
		
	    }
	    @comment "Shield"
	    v[313] += v[314]
	    v[371] = between(v[51], v[312], v[312] + 110) && between(v[52], v[313], v[313] + 11) ? 4 : 0
	    @pic[v[543]].getInfo .cewh .currentRect v[1952], v[1953], v[1954], v[1954]
	    @if v[371] == 4 {
		@pic[v[543]].move {
		    .pos v[1952], v[1953] .center
		    .scale 100
		    .trans 0
		    .time -2
		    .rgbs 0, 200, 0, 100
		}
		v[84] = 2
		s[201].on
		v[11] = v[852]
		@if v[11] >= 1 {
		    @if v[84] != v[85] {
			v[84..85] = v[84]
			@call .cev 396
			@if v[175] >= 0 {
			    v[12] = v[173]
			    v[13] = 2
			    v[19] = v[171]
			    @call .cev 1980
			    
			}
			v[1943] = v[1903] + 100
			v[1944] = v[1908] / 1000
			@if s[58] .isOn() {
			    v[15] = 2
			    @call .cev 1932
			    
			}
			@if v[v[175]] == 0 {
			    v[353] = v[157] + v[1251]
			    v[354] = v[158] + v[1252]
			    @pic[v[541]].strpic {
				"\t[20047]"
				.pos v[353], v[354] .left
				.size 0, 0                        .chromakey 1
				.scale 100
				.trans 0
				.rgbs 100, 100, 100, 100
				.font "misaki_gothic", 10
				.spacing 0, 0
				.skin "" .nobg .noframe .noPadding
				.mapLayer 9
				.eraseWhenTransfer
				.affectedByFlash
				.affectedByShake
			    }
			    
			}
			
		    }
		    @if v[175] >= 0 {
			@if v[43] == 1006 {
			    v[1951] = 2 & v[v[284] + 250]
			    @if s[13] .isOff() {
				v[13] = 2
				v[14] = 0
				@call .cev 1934
				
			    }
			    
			}
			
		    }
		    
		} .else bl {
		    s[201].off
		    
		}
		
	    } .else bl {
		@pic[v[543]].move {
		    .pos v[1952], v[1953] .center
		    .scale 100
		    .trans 0
		    .time -2
		    .rgbs 100, 100, 100, 100
		}
		
	    }
	    @comment "Armor"
	    v[313] += v[314]
	    v[371] = between(v[51], v[312], v[312] + 110) && between(v[52], v[313], v[313] + 11) ? 4 : 0
	    @pic[v[544]].getInfo .cewh .currentRect v[1952], v[1953], v[1954], v[1954]
	    @if v[371] == 4 {
		@pic[v[544]].move {
		    .pos v[1952], v[1953] .center
		    .scale 100
		    .trans 0
		    .time -2
		    .rgbs 0, 200, 0, 100
		}
		v[84] = 3
		s[201].on
		v[11] = v[853]
		@if v[11] >= 1 {
		    @if v[84] != v[85] {
			v[84..85] = v[84]
			@call .cev 397
			@if v[175] >= 0 {
			    v[12] = v[173]
			    v[13] = 3
			    v[19] = v[171]
			    @call .cev 1980
			    
			}
			v[1943] = v[1903] + 100
			v[1944] = v[1908] / 1000
			@if s[58] .isOn() {
			    v[15] = 3
			    @call .cev 1932
			    
			}
			@if v[v[175]] == 0 {
			    v[353] = v[157] + v[1251]
			    v[354] = v[158] + v[1252]
			    @pic[v[541]].strpic {
				"\t[20047]"
				.pos v[353], v[354] .left
				.size 0, 0                        .chromakey 1
				.scale 100
				.trans 0
				.rgbs 100, 100, 100, 100
				.font "misaki_gothic", 10
				.spacing 0, 0
				.skin "" .nobg .noframe .noPadding
				.mapLayer 9
				.eraseWhenTransfer
				.affectedByFlash
				.affectedByShake
			    }
			    
			}
			
		    }
		    @if v[175] >= 0 {
			@if v[43] == 1006 {
			    v[1951] = pow(2, 3 - 1) & v[v[284] + 250]
			    @if s[13] .isOff() {
				v[13] = 3
				v[14] = 0
				@call .cev 1934
				
			    }
			    
			}
			
		    }
		    
		} .else bl {
		    s[201].off
		    
		}
		
	    } .else bl {
		@pic[v[544]].move {
		    .pos v[1952], v[1953] .center
		    .scale 100
		    .trans 0
		    .time -2
		    .rgbs 100, 100, 100, 100
		}
		
	    }
	    @comment "Helm"
	    v[313] += v[314]
	    v[371] = between(v[51], v[312], v[312] + 110) && between(v[52], v[313], v[313] + 11) ? 4 : 0
	    @pic[v[545]].getInfo .cewh .currentRect v[1952], v[1953], v[1954], v[1954]
	    @if v[371] == 4 {
		@pic[v[545]].move {
		    .pos v[1952], v[1953] .center
		    .scale 100
		    .trans 0
		    .time -2
		    .rgbs 0, 200, 0, 100
		}
		v[84] = 4
		s[201].on
		v[11] = v[854]
		@if v[11] >= 1 {
		    @if v[84] != v[85] {
			v[84..85] = v[84]
			@call .cev 398
			@if v[175] >= 0 {
			    v[12] = v[173]
			    v[13] = 4
			    v[19] = v[171]
			    @call .cev 1980
			    
			}
			v[1943] = v[1903] + 100
			v[1944] = v[1908] / 1000
			@if s[58] .isOn() {
			    v[15] = 4
			    @call .cev 1932
			    
			}
			@if v[v[175]] == 0 {
			    v[353] = v[157] + v[1251]
			    v[354] = v[158] + v[1252]
			    @pic[v[541]].strpic {
				"\t[20047]"
				.pos v[353], v[354] .left
				.size 0, 0                        .chromakey 1
				.scale 100
				.trans 0
				.rgbs 100, 100, 100, 100
				.font "misaki_gothic", 10
				.spacing 0, 0
				.skin "" .nobg .noframe .noPadding
				.mapLayer 9
				.eraseWhenTransfer
				.affectedByFlash
				.affectedByShake
			    }
			    
			}
			
		    }
		    @if v[175] >= 0 {
			@if v[43] == 1006 {
			    v[1951] = pow(2, 4 - 1) & v[v[284] + 250]
			    @if s[13] .isOff() {
				v[13] = 4
				v[14] = 0
				@call .cev 1934
				
			    }
			    
			}
			
		    }
		    
		} .else bl {
		    s[201].off
		    
		}
		
	    } .else bl {
		@pic[v[545]].move {
		    .pos v[1952], v[1953] .center
		    .scale 100
		    .trans 0
		    .time -2
		    .rgbs 100, 100, 100, 100
		}
		
	    }
	    @comment "Acc"
	    v[313] += v[314]
	    v[371] = between(v[51], v[312], v[312] + 110) && between(v[52], v[313], v[313] + 11) ? 4 : 0
	    @pic[v[546]].getInfo .cewh .currentRect v[1952], v[1953], v[1954], v[1954]
	    @if v[371] == 4 {
		@pic[v[546]].move {
		    .pos v[1952], v[1953] .center
		    .scale 100
		    .trans 0
		    .time -2
		    .rgbs 0, 200, 0, 100
		}
		v[84] = 5
		s[201].on
		v[11] = v[855]
		@if v[11] >= 1 {
		    @if v[84] != v[85] {
			v[84..85] = v[84]
			@call .cev 399
			@if v[175] >= 0 {
			    v[12] = v[173]
			    v[13] = 5
			    v[19] = v[171]
			    @call .cev 1980
			    
			}
			v[1943] = v[1903] + 100
			v[1944] = v[1908] / 1000
			@if s[58] .isOn() {
			    v[15] = 5
			    @call .cev 1932
			    
			}
			@if v[v[175]] == 0 {
			    v[353] = v[157] + v[1251]
			    v[354] = v[158] + v[1252]
			    @pic[v[541]].strpic {
				"\t[20047]"
				.pos v[353], v[354] .left
				.size 0, 0                        .chromakey 1
				.scale 100
				.trans 0
				.rgbs 100, 100, 100, 100
				.font "misaki_gothic", 10
				.spacing 0, 0
				.skin "" .nobg .noframe .noPadding
				.mapLayer 9
				.eraseWhenTransfer
				.affectedByFlash
				.affectedByShake
			    }
			    
			}
			
		    }
		    @if v[175] >= 0 {
			@if v[43] == 1006 {
			    v[1951] = pow(2, 5 - 1) & v[v[284] + 250]
			    @if s[13] .isOff() {
				v[13] = 5
				v[14] = 0
				@call .cev 1934
				
			    }
			    
			}
			
		    }
		    
		} .else bl {
		    s[201].off
		    
		}
		
	    } .else bl {
		@pic[v[546]].move {
		    .pos v[1952], v[1953] .center
		    .scale 100
		    .trans 0
		    .time -2
		    .rgbs 100, 100, 100, 100
		}
		
	    }
	    @comment "ResWeapon"
	    v[313] += v[314]
	    v[371] = between(v[51], v[312], v[312] + 110) && between(v[52], v[313], v[313] + 11) ? 4 : 0
	    @pic[v[547]].getInfo .cewh .currentRect v[1952], v[1953], v[1954], v[1954]
	    @if v[371] == 4 {
		@pic[v[547]].move {
		    .pos v[1952], v[1953] .center
		    .scale 100
		    .trans 0
		    .time -2
		    .rgbs 0, 200, 0, 100
		}
		v[84] = 1
		s[201].on
		v[11] = v[856]
		@if v[11] >= 1 {
		    @if v[84] != v[85] {
			v[84..85] = 1
			@call .cev 395
			@if v[175] >= 0 {
			    v[12] = v[173]
			    v[13] = 6
			    v[19] = v[171]
			    @call .cev 1980
			    
			}
			v[1943] = v[1903] + 100
			v[1944] = v[1908] / 1000
			@if s[58] .isOn() {
			    v[15] = 1
			    @call .cev 1932
			    
			}
			@if v[v[175]] == 0 {
			    v[353] = v[157] + v[1251]
			    v[354] = v[158] + v[1252]
			    @pic[v[541]].strpic {
				"\t[20047]"
				.pos v[353], v[354] .left
				.size 0, 0                        .chromakey 1
				.scale 100
				.trans 0
				.rgbs 100, 100, 100, 100
				.font "misaki_gothic", 10
				.spacing 0, 0
				.skin "" .nobg .noframe .noPadding
				.mapLayer 9
				.eraseWhenTransfer
				.affectedByFlash
				.affectedByShake
			    }
			    
			}
			
		    }
		    @if v[175] >= 0 {
			@if v[43] == 1006 {
			    v[1951] = 1 & v[v[284] + 250]
			    @if s[13] .isOff() {
				v[13] = 1
				v[14] = 1
				@call .cev 1934
				
			    }
			    
			}
			
		    }
		    
		} .else bl {
		    s[201].off
		    
		}
		
	    } .else bl {
		@pic[v[547]].move {
		    .pos v[1952], v[1953] .center
		    .scale 100
		    .trans 0
		    .time -2
		    .rgbs 100, 100, 100, 100
		}
		
	    }
	    @comment "ResShield"
	    v[313] += v[314]
	    v[371] = between(v[51], v[312], v[312] + 110) && between(v[52], v[313], v[313] + 11) ? 4 : 0
	    @pic[v[548]].getInfo .cewh .currentRect v[1952], v[1953], v[1954], v[1954]
	    @if v[371] == 4 {
		@pic[v[548]].move {
		    .pos v[1952], v[1953] .center
		    .scale 100
		    .trans 0
		    .time -2
		    .rgbs 0, 200, 0, 100
		}
		v[84] = 2
		s[201].on
		v[11] = v[857]
		@if v[11] >= 1 {
		    @if v[84] != v[85] {
			v[84..85] = v[84]
			@call .cev 396
			@if v[175] >= 0 {
			    v[12] = v[173]
			    v[13] = 7
			    v[19] = v[171]
			    @call .cev 1980
			    
			}
			v[1943] = v[1903] + 100
			v[1944] = v[1908] / 1000
			@if s[58] .isOn() {
			    v[15] = 2
			    @call .cev 1932
			    
			}
			@if v[175] == 0 {
			    v[353] = v[157] + v[1251]
			    v[354] = v[158] + v[1252]
			    @pic[v[541]].strpic {
				"\t[20047]"
				.pos v[353], v[354] .left
				.size 0, 0                        .chromakey 1
				.scale 100
				.trans 0
				.rgbs 100, 100, 100, 100
				.font "misaki_gothic", 10
				.spacing 0, 0
				.skin "" .nobg .noframe .noPadding
				.mapLayer 9
				.eraseWhenTransfer
				.affectedByFlash
				.affectedByShake
			    }
			    
			}
			
		    }
		    @if v[175] >= 0 {
			@if v[43] == 1006 {
			    v[1951] = 2 & v[v[284] + 250]
			    @if s[13] .isOff() {
				v[13] = 2
				v[14] = 1
				@call .cev 1934
				
			    }
			    
			}
			
		    }
		    
		} .else bl {
		    s[201].off
		    
		}
		
	    } .else bl {
		@pic[v[548]].move {
		    .pos v[1952], v[1953] .center
		    .scale 100
		    .trans 0
		    .time -2
		    .rgbs 100, 100, 100, 100
		}
		
	    }
	    @comment "Skills"
	    @loop 4 .dst v[343] {
		v[1951] = 741 + v[343] * 20
		@if v[v[1951]] >= 1 {
		    v[1942] = 320
		    v[371] = between(v[51], v[312], v[312] + 110) && between(v[52], v[158] + v[1942] + 10 * v[343], v[158] + v[1942] + 11 + 10 * v[343]) ? 4 : 0
		    @if v[371] == 4 {
			v[84] = v[343] + 20
			s[201].on
			@if v[84] != v[85] {
			    @if s[58] .isOn() {
				@comment "スキルチェック"
				v[301] = v[1951]
				@comment "番号を見る"
				v[84] = v[v[301]]
				@comment "skillが存在するなら文章を見る"
				@if v[84] >= 1 {
				    s[202].off
				    v[1942] = v[52] + 0
				    v[1942].swap v[1065], 1
				    @call .cev 1200
				    v[1942].swap v[1065], 1
				    v[85] = v[84]
				    
				}
				
			    }
			    v[353] = v[157] + v[1251]
			    v[354] = v[158] + v[1252]
			    @pic[v[541]].strpic {
				"\t[20051]"
				.pos v[353], v[354] .left
				.size 0, 0                        .chromakey 1
				.scale 100
				.trans 0
				.rgbs 100, 100, 100, 100
				.font "misaki_gothic", 10
				.spacing 0, 0
				.skin "" .nobg .noframe .noPadding
				.mapLayer 9
				.eraseWhenTransfer
				.affectedByFlash
				.affectedByShake
			    }
			    
			}
			@if v[43] == 1006 {
			    @comment "#Is_Companion"
			    @if s[13] .isOff() {
				@if v[555] != 996 {
				    @se.play "click1" .opt 80, 100, 50
				    @comment "#Skill AutoCast Lock Check"
				    v[344] = v[(v[256] - 1) * 300 + v[1261] + 199]
				    v[0] = (v[344] & pow(2, v[343])) > 0 ? (v[(v[256] - 1) * 300 + v[1261] + 199] = v[344] ^ pow(2, v[343])) : (v[(v[256] - 1) * 300 + v[1261] + 199] = v[344] | pow(2, v[343]))
				    @call .cev 1949
				    
				}
				
			    }
			    s[13].on
			    
			} .else bl {
			    s[13].off
			    
			}
			
		    }
		    
		}
		
	    }
	    
	    @comment "END"
	    @if s[201] .isOff() {
		v[85..85] = 0
		@pic[v[541]].erase
		@pic[996].erase
		
	    }
	    @wait 0
	    @if v[43] == 1005 {
		@if s[11] .isOff() {
		    s[58].toggle
		    v[85..85] = 0
		    @se.play "click1" .opt 80, 100, 50
		    @pic[996].erase
		    
		}
		s[11].on
		
	    } .else bl {
		s[11].off
		
	    }
	    @if v[43] == 1006 {
		s[13].on
		
	    } .else bl {
		s[13].off
		
	    }
	    
	}

	@pic[996].erase
	@pic[1230..1300].erase
	@pic[1500..1601].erase
	@pic[v[555]..v[556]].erase
	@if s[20] .isOn() {
	    @comment "Inventry mode"
	    @pic[2135].erase
	    s[18].on
	    s[38].off
	    s[43].off
	    s[51].on
	    s[39].on
	    @if v[2401] >= 5 {
		@call .cev 2094
		
	    }
	    
	}
	s[19].off
	S_OpenInv.off
	v[959] = 24
	v[909] = 24
}
