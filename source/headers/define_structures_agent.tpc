// I actually wanted to define those defvs like "agent.brabrabra = n" but in TPC syntax it's invalid, sadly.
vname[537], "AgentIDHolder"
defv AgentIDholder = 537

struct("agent",{
	def agent_Basic_Array_size = 300
	def agent_Basic_Array_size_PLUSONE = agent_Basic_Array_size + 1
	defv {

	Address_str_agent_name_array_head = 4562

	Address_agent_array_head = 600

	//This should have been named AgentType but inheriting old name 
	agent_ObjectType = 601
	//you need to replace it with this new naming to show more precise element name
	agent_AgentType = 601

	agent_PicID = 602
	agent_AgentBits = 603
	agent_StaticBits = 603
	agent_Luck = 604



	agent_MilPixX = 605
	agent_MilPixY = 606
	agent_RelativeX = 607
	agent_RelativeY = 608
	agent_Morton = 609
	agent_Width = 610
	agent_Height = 611
	agent_MilPixVx = 612
	agent_MilPixVy = 613
	agent_MilPixVab = 614
	agent_MilPixAx = 615
	agent_MilPixAy = 616

	agent_BaseCamoValue = 617 
	agent_TargetAgentID = 618
	agent_MovePointX = 619 
	agent_MovePointY = 620
	agent_MoveUvectorX = 621
	agent_MoveUvectorY = 622
	agent_MilPixMoveOrderedPointDist = 623
	agent_MarkerColor = 623

	agent_ObjectCollideSkipFrame = 625

	agent_MapX = 626
	agent_MapY = 627

	agent_AATimer = 628
	agent_AttackFrame = 629
	agent_AttackDelay = 630
	agent_LastTarget = 631
	agent_TileLink = 632
	agent_AI_decision_bits = 633
	agent_AI_routine_bits = 634
	agent_Cohort_ID = 635


	agent_SpriteX = 636
	agent_SpriteY = 637
	agent_MoveTypeBIts = 638
	agent_ColDimension = 639 // ? maybe used in collision proc
	agent_TerrainIDstanding = 640

	agent_HoldPointX = 641
	agent_HoldPointy = 642
	agent_WayPoint1X= 643
	agent_WayPoint1Y = 644
	agent_WayPoint2X= 645
	agent_WayPoint2Y = 646
	agent_WayPoint3X= 647
	agent_WayPoint3Y = 648
	agent_WayPoint4X= 649
	agent_WayPoint4Y = 650
	agent_WayPoint5X= 651
	agent_WayPoint5Y = 652
	agent_WayPoint6X= 653
	agent_WayPoint6Y = 654

	agent_LeftWPtoChase = 655
	agent_MarchingDirection = 656

	agent_getTerrainElevation = 657
	agent_SaveActualTeamID = 658 // ... is this even necessary? <- I saw this is used in remove agent function
	agent_saveFoWPoint = 659
	// agent_killXP = 659 // ported to AEB
	
	// agent_gotXP = 660 // ?
	agent_AbsoluteX  = 661
	agent_AbsoluteY  = 662

	// agent_UniqueCharIndex=661 //if <0, refer PartyCompanions this one also should be ported to AEB
	agent_Skin = 663 // 0=Rtpian, 1=Nord, 2= Azghazi, 6= female ...This parameter is for UserCharactors
	agent_Race = 664 // 0=Human,1=Goblin,2=Orc,3=Dragons,
	agent_PerkFlagBits1 = 665 // 1=ShieldMaster,2=Brawny,4=BattleForged,8=Nimble,16=Stalwart,32=Dodge,64=Anticipation,128=Pathfinder,256=Fearsome
	agent_PerkFlagBits2 = 666 // 1=KillingFrenzy,2=BattleFlow,4=Berserk,8=HeadHunter, ////MASTERIES 16=M_Sword,32=M_Spear,64=M_Axe,128=M_Hammer,256=M_Mace,512=M_Cleaver,1024=M_Dagger,2048=M_Throwing,4096=M_res1,8192=M_res2,16384=M_bow,32768=M_crossbow,65536=M_res3 131072=spellcaster

	agent_ScriptFlags = 668
	agent_HeadID = 669 //999999=fullcovered
		agent_GENERATION_Hair = 670 // will be abolished

	agent_Buff1 = 671
	agent_Buff2 = 672
	agent_Buff3 = 673
	agent_Buff4 = 674
	agent_Buff5 = 675
	agent_Buff6 = 676
	agent_Buff7 = 677
	agent_Buff8 = 678
	agent_BuffAmount = 679


	agent_InCombatTimer = 680
	agent_MeleeFightTimer = 681 
	agent_HitMoveTimer = 682
	agent_ShieldMotionTimer = 683
	agent_ActionTimer = 684

	agent_DodgeTimer = 685
	agent_BuffTimer1 = 686
	agent_BuffTimer2 = 687
	agent_BuffTimer3 = 688
	agent_BuffTimer4 = 689
	agent_BuffTimer5 = 690
	agent_BuffTimer6 = 691
	agent_BuffTimer7 = 692	
	agent_BuffTimer8 = 693
	agent_PassiveTimer = 694

	agent_Skill1CDtimer = 695
	agent_Skill2CDtimer = 696
	agent_Skill3CDtimer = 697
	agent_Skill4CDtimer = 698
	agent_RegTimer = 699

	agent_TeamID = 700
	agent_UnitID = 701
	agent_UnitType = 702
	agent_AAType = 703 //0 = melee, 1 = ranged, 2 = point, 3 = shoot, 4 = function
	agent_Level = 704
	agent_MaxHP = 705
	agent_HP = 706
	agent_MaxSP = 707
	agent_SP = 708
	agent_BaseAD = 709
	agent_BaseAP = 710
	agent_MaxAR = 738
	agent_BaseAR = 711
	agent_BaseMR = 712
	agent_BaseHIT = 713
	agent_BaseEVA = 714
	agent_BaseCrit = 715
	agent_BaseMS = 716
	agent_BaseRange_max = 717
	agent_BaseRange_min = 718
	agent_BaseAS = 719 // (4800 - [AS])

	agent_AAMotion = 720
	agent_AACost = 721
	agent_AA_ARorMR=722
	agent_AAElement=723
	agent_AABits = 724
	agent_AddMotionBits = 725
	agent_ExMotionFlags = 726

	agent_AAamount = 727
	agent_AAvelocity = 727
	agent_AAtime = 728


	agent_AASfx = 729
	agent_AAFunction = 730
	agent_BaseRegHP = 731
	agent_Shield_Value = 735
	agent_AA_AR_effectiveness = 736
	agent_AA_AR_penetration = 737
	//agent_MaxAR = 738
	agent_BaseWill = 739
	agent_BaseObjBit = 740
	agent_skill1_CD = 748



	agent_Passive_Text = 821 // this maybe can be relocated into AEB
	agent_Culture_Icon = 822
	agent_Culture = 822
	
	agent_Passive_Type_Flag = 823
	
	agent_ChokeTimer = 827


	agent_HeadSPregPenalty = 828
	agent_TakenDamageMultiplier = 829

	agent_UnitEyeSight_for_AgentSearch = 830

	agent_Ammo = 832 //0x00(Max Ammo of Sub Weapon)0x00(CurrentAmmo of Sub Weapon)0x00(Max Ammo of Current Weapon)0x00(current Ammo of Sub Weapon) 
	agent_ShieldType = 833
	agent_ShieldBreakResistance = 834
	agent_ShieldRangedProtection = 835
	agent_RHitAndMHit = 836

	agent_CritChanceReduction = 839
	agent_CritDamageReduction = 840

	agent_StanceOrder = 841
	agent_MovementOrder = 842
	agent_ActionState = 843

	agent_Direction = 844

	agent_ActionFlag = 845 // used to hold dir, but now used as bits
	agent_CastSkillOrder = 846
	agent_worker_JobType = 847
	agent_TacticsOrderFlag = 848
	agent_KnockBackTimer = 849
	agent_ForceSprite = 850

	agent_MainWeaponID = 851
	agent_MainShieldID = 852
	agent_ArmorID = 853
	agent_HelmID = 854
	agent_AccID = 855
	agent_ReserveWeaponID = 856
	agent_ReserveShieldID = 857
	agent_HorseID = 858 // unco

	agent_Formbits = 859
		agent_static_MapXdiv5 = 858
		agent_static_MapYdiv5 = 859

	agent_Morale = 860
	agent_ProcessAD = 861
	agent_ProcessAP = 862
	agent_ProcessAR = 863
	agent_ProcessMR = 864
	agent_ProcessHIT = 865
	agent_ProcessEVA = 866
	agent_ProcessCrit = 867
	agent_ProcessMS = 868
	agent_ProcessRange_max = 869
	agent_ProcessRange_min = 870
	agent_ProcessAS = 871
	agent_ProcessHPreg = 872
	agent_ProcessSPReg = 873

	agent_ProcessObjBit = 874
	agent_ProcessWill = 875
	agent_ProcessCamoValue = 876
	agent_ProcessInstantState = 877
	
	// initial offsets are basically for simple sprite agents and Static agents.
	// If the agent is custom agent, InitialOffsetXY will be used for the fall down effect upon their death.
	// And, unless the agent is simple sprite agent, InitialOffsetXY will be init upon their death. 
	// see => module_core_RTS_battlesystem_remove_agent.tpc
	agent_InitialOffsetX = 881
	agent_InitialOffsetY = 882

	agent_SpriteOrder = 883
	agent_ShieldFlash = 884
	agent_2hweapon_stain = 885
	agent_FootstepSoundTimer = 886
	agent_FootstepSoundType = 887

	agent_LastSpriteIndex = 890
	agent_R = 891
	agent_G = 892
	agent_B = 893
	agent_Saturation = 894
	agent_FlashType = 895
	agent_OneTimeOffsetX = 896
	agent_OneTimeOffsetY = 897
	agent_Transparency = 898
	agent_PictArray = 899
	agent_generated_ID = 900
	}

	defv {

	}

	//Additional Agent Picture Buffer setting - AEB - pic buffer
	def {
	//Buffer PicID -> const_picture_ids.tpc

	// AEB holds agent parameters that are not very frequently changed.

	AgentExtraBuffer_ArraySize = 256 // experimental
	AgentExtraBuffer_ArrayAmount = Agents_Limit + 1 //AEB[0] will be used as configuration for the array work

	AgentExBuffer_SLOT_Ptr_To_BasicArray = 0 
	AgentExBuffer_SLOT_MetaTeam = 1
	// ACHTUNG - about MetaTeam, you have to change several function including agent team change

	AgentExBuffer_SLOT_ColBoxWidth = 2
	AgentExBuffer_SLOT_ColBoxHeight = 3
	AgentExBuffer_SLOT_BaseEyeSight = 4 // abolished
	AgentExBuffer_SLOT_Taken_down_XP = 5
	AgentExBuffer_SLOT_BaseSight_Root = 6

	AgentExBuffer_SLOT_ActionSprite_1 = 7
	AgentExBuffer_SLOT_ActionSprite_2 = 8
	AgentExBuffer_SLOT_ActionSprite_3 = 9
	AgentExBuffer_SLOT_ActionSprite_4 = 10
	AgentExBuffer_SLOT_ActionSprite_5 = 11

	
	ClassType_Amount = 11
	AgentExBuffer_SLOT_Class_Target_Priority_Array = 200 //temp


	}


	//FLAGS
	def {
	//Perks1


	
	// erase all agent_ prefix eventually 
	
	agent_PerkFlagBits1_FLAG_Pathfinder = 128
	PerkFlagBits1_FLAG_Shieldmaster = 1
	PerkFlagBits1_FLAG_BattleForged = 4
	PerkFlagBits1_FLAG_Nimble = 8
	PerkFlagBits1_FLAG_Dodge = 32
	PerkFlagBits1_FLAG_Pathfinder = 128
	PerkFlagBits1_FLAG_Fearsome = 256
	PerkFlagBits1_FLAG_Ninelives = 2048
	PerkFlagBits1_FLAG_Backstab = 4096
	PerkFlagBits1_FLAG_Strider = 8192
	PerkFlagBits1_FLAG_UnseenThreat = 32768

	PerkFlagBits1_FLAG_Indomitable = 131072

	PerkFlagBits2_FLAG_KillingFrenzy = 1
	PerkFlagBits2_FLAG_BattleFlow = 2
	PerkFlagBits2_FLAG_Berserk = 4
	PerkFlagBits2_FLAG_Grimreaper = 262144
	PerkFlagBits2_FLAG_Overwhelm = 2097152
	PerkFlagBits3_FLAG_Feint = 4194304


	PerkFlagBits3_FLAG_Mountainblade = 64
	PerkFlagBits3_FLAG_HorseArcher = 128
	PerkFlagBits3_FLAG_Parthian = 256
	PerkFlagBits3_FLAG_Expert_Velites = 1048576


	// script flags
	ScriptFlags_has_EV_OnDeath = 1 // call on death


	//Agent bits
	AgentBits_AmbushFlag = 1
	AgentBits_horse_in_forest = 8
	AgentBits_Inertia = 16
	AgentBits_Skate = 32

	AgentBits_Collided_Other_Agent = 64
	AgentBits_Endpoint_Collision_Trouble = 128
	AgentBits_Movement_Giveup = 256
	AgentBits_Discipline_Col = 512
	AgentBits_Hovering = 1024

	// AgentBits_FLAG_KILLED = 16384 
	AgentBits_FLAG_can_clickable = 16384 

	AgentBits_FLAG_EnableBasicSkillAI = 524288
	AgentBits_FLAG_EnableBasicAI = 1048576
	AgentBits_FLAG_EnableCivAI = 2097152
	AgentBits_FLAG_ForcemoveFlag = 4194304
	AgentBits_FLAG_walldetected = 8388608
	AgentBits_FLAG_NeedWpToReachObj = 16777216
	AgentBits_FLAG_PF_walldetection_switch = 33554432 // if this switch is on for seconds, start checking if the agent is stuck on wall or sth
	AgentBits_FLAG_1fprocessed = 67108864

	AgentBits_FLAG_DirChange_skip = 134217728
	AgentBits_FLAG_Pushed_by_terrain = 536870912
	AgentBits_FLAG_Drawn_in_screen = 1073741824 //31bit

		AgentBits_MASK_for_initilizing_pathfinding = ~(AgentBits_FLAG_walldetected + AgentBits_FLAG_NeedWpToReachObj + AgentBits_FLAG_PF_walldetection_switch)


	// for static agents
	StaticBits_FLAG_working_on_tech = 1
	StaticBits_FLAG_has_generated_sprite = 128
	StaticBits_FLAG_has_gate_function = 256
	StaticBits_FLAG_flammable = 2048
	StaticBits_FLAG_newly_generated_static = 16384
	StaticBits_FLAG_has_wreck_system = 4194304


	MoveTypeBits_Flying = 1
	MoveTypeBits_Horse = 2
	MoveTypeBits_Skate = 8
	MoveTypeBits_Snow = 16
	MoveTypeBits_Roller = 32
	MoveTypeBits_Amphibious = 64
	MoveTypeBits_Sand = 128
	
	//AI decision bits for combat units
	//swap series
	AI_decision_bits_FLAG_Have_reserve_set = 1
	AI_decision_bits_FLAG_Try_swapping_weapon = 2
	AI_decision_bits_FLAG_Sub_WEP_is_Melee = 4
	AI_decision_bits_FLAG_Sub_WEP_is_Ranged = 8
	AI_decision_bits_FLAG_Sub_WEP_is_Magic = 16
	AI_decision_bits_FLAG_Sub_WEP_is_Charge = 32
	AI_decision_bits_FLAG_Sub_WEP_is_Buff = 64
	AI_decision_bits_FLAG_Sub_WEP_is_Heal = 128
	AI_decision_bits_FLAG_Out_of_Current_WEP_Ammo = 256
	AI_decision_bits_FLAG_Out_of_Sub_WEP_Ammo = 512
		AI_decision_bits_KILL_FLAGs_Out_of_Ammo= -769
	AI_decision_bits_FLAG_Sub_WEP_needs_Ammo = 2048
	AI_decision_bits_FLAG_Currently_Melee = 4096
	AI_decision_bits_FLAG_Currently_Ranged = 8192
	AI_decision_bits_FLAG_Currently_Magic = 16384
	AI_decision_bits_FLAG_Currently_Charge = 32768
	AI_decision_bits_FLAG_Currently_Buff = 65536
	AI_decision_bits_FLAG_Currently_Heal = 131072

	// trebuchet bit
	AI_decision_bits_FLAG_Need_to_be_packed_to_move = 262144

	AI_routine_bits_FLAG_Forbid_AI_WeaponChange = 67108864 // AI_routine_bits??!?!?
		AI_decision_bits_FLAGs_can_change_flags_all = 4+8+16+32+64+128
		AI_decision_bits_KILL_ALL_WEAPONCHANGE_FLAG = ~(1+2+4+8+16+32+64+128+256+512+4096+8192)
	
	
	AI_decision_bits_FLAG_Forbid_AI_decision = 1073741824//31bit

	//AI routine bits
	AI_routine_bits_FLAG_siegeweapon_flag = 1
	AI_routine_bits_FLAG_skirmisher=2
	AI_routine_bits_FLAG_assassin=4
	AI_routine_bits_FLAG_ranged=8
	AI_routine_bits_FLAG_targetting_ally=16
	AI_routine_bits_FLAG_target_switched_by_AI=32
	AI_routine_bits_FLAG_IdleAfterEnemySearch=64
	AI_routine_bits_FLAG_AICohortGatheringAttack=128
	AI_routine_bits_FLAG_tracing_flag = 4096 // this flag means tracing WALL. odd naming since it's from legacy pathfinding
	AI_routine_bits_FLAG_tracing_wp=8192
	AI_routine_bits_FLAG_PATHFINDING =16384
		AI_routine_bits_KILL_FLAG_PATHFINDING=-16385
	AI_routine_bits_FLAG_PFcontinue = 32768
		AI_routine_bits_KILL_FLAG_PFcontinue=-32769
		AI_routine_bits_FLAG_COMPOUND_PF_and_PFcontinue = AI_routine_bits_FLAG_PATHFINDING + AI_routine_bits_FLAG_PFcontinue 
	AI_routine_bits_FLAG_PFskip = 65536
		
	AI_routine_bits_FLAG_Manual_Ordered = 131072
	AI_routine_bits_FLAG_PF2Agent = 524288
	AI_routine_bits_FLAG_AIskip = 2097152
	AI_routine_bits_FLAG_ForcemoveFlag = 4194304
	AI_routine_bits_FLAG_Pathblocked = 8388608
	AI_routine_bits_FLAG_GroupPath = 16777216
	AI_routine_bits_FLAG_RayCast = 33554432
	AI_routine_bits_FLAG_WP_set_by_RayCast = 67108864
	AI_routine_bits_FLAG_1secDelay_PF = 134217728
	AI_routine_bits_FLAG_StuckCheckReady = 268435456

		AI_routine_bits_KILL_StuckCheckReady = ~AI_routine_bits_FLAG_StuckCheckReady

		AI_routine_bits_MASK_init_raycasting = (AI_routine_bits_FLAG_WP_set_by_RayCast + AI_routine_bits_FLAG_RayCast+AI_routine_bits_FLAG_Prioritize_Raycasting)
		AI_routine_bits_MASK_for_initilizing_pathfinding = ~(AI_routine_bits_FLAG_tracing_flag + AI_routine_bits_FLAG_PATHFINDING + AI_routine_bits_FLAG_PFcontinue + AI_routine_bits_FLAG_Pathblocked + AI_routine_bits_FLAG_GroupPath + AI_routine_bits_FLAG_WP_set_by_RayCast + AI_routine_bits_FLAG_RayCast+AI_routine_bits_FLAG_StuckCheckReady + AI_routine_bits_FLAG_1secDelay_PF)


	//ObjBits
	BaseObjBit_FLAG_Ambushing = 1
	BaseObjBit_FLAG_Immune_to_Knock_back = 8
	BaseObjBit_FLAG_RangedDamageResist = 32
	BaseObjBit_FLAG_HalveAllDamage = 64
	BaseObjBit_FLAG_Immune_to_MeleePenalty = 128
	BaseObjBit_FLAG_No_mind = 256
	BaseObjBit_FLAG_Fleeing = 512
	BaseObjBit_FLAG_Flip_sprite = 1024
	BaseObjBit_FLAG_Cause_Demoralizing = 2048
	BaseObjBit_FLAG_Immune_to_bleed = 4096
	BaseObjBit_FLAG_ShieldBash = 8192
	
	BaseObjBit_FLAG_Discipline = 16384
	BaseObjBit_FLAG_Relentless = 32768
	BaseObjBit_FLAG_Immune_to_stun = 65536
	BaseObjBit_FLAG_Duelist_Activated = 131072
	BaseObjBit_FLAG_Silence = 262144
	BaseObjBit_FLAG_big_unit = 524288
	BaseObjBit_FLAG_Standard_Bearer = 1048576
	BaseObjBit_FLAG_Explosive = 2097152
	BaseObjBit_FLAG_HeroAura = 4194304
	BaseObjBit_FLAG_CanParry = 16777216
	BaseObjBit_FLAG_LanceCharge = 33554432
	BaseObjBit_FLAG_Brokenshield = 67108864
	BaseObjBit_FLAG_SpeedBonus = 134217728
	BaseObjBit_FLAG_Invincible = 1073741824


	// add motions
	AddMotionFlags_FLAG_Armor_has_second_sprite_line = 1 

	AddMotionFlags_FLAG_Pointy_Onehanded_Weapon = 32 
	AddMotionFlags_FLAG_Blink_start = 64 
	AddMotionFlags_FLAG_Blink_close = 128 
	AddMotionFlags_FLAG_Camel = 1024 
	AddMotionFlags_FLAG_OutOfBreath = 2048 
	AddMotionFlags_FLAG_IdleAction = 4096 
	AddMotionFlags_FLAG_OnHorse = 8192

	//ExMotions

	ExMotionFlags_FLAG_have_AA_CD_Spr = 1
	ExMotionFlags_FLAG_slimy = 8
	ExMotionFlags_FLAG_have_fundamental_movemotion = 16
	ExMotionFlags_FLAG_MoveAnim_OneDirectional = 256
	ExMotionFlags_FLAG_MoveAnim = 512
	ExMotionFlags_FLAG_no_footstepsound = 1024
	ExMotionFlags_FLAG_no_fatigue = 2048
	ExMotionFlags_FLAG_ArmorHasDamagedSprite = 8192
	ExMotionFlags_FLAG_ArmorNotYetDamaged = 16384
		ExMotionFlags_MASK_ArmorDamageChecker = ExMotionFlags_FLAG_ArmorHasDamagedSprite + ExMotionFlags_FLAG_ArmorNotYetDamaged

	ExMotionFlags_FLAG_HeadHasDamagedSprite = 32768
	ExMotionFlags_FLAG_HeadNotYetDamaged = 65536
		ExMotionFlags_MASK_HeadPartDamageChecker = ExMotionFlags_FLAG_HeadHasDamagedSprite + ExMotionFlags_FLAG_HeadNotYetDamaged
	ExMotionFlags_FLAG_Backshotflag = 67108864
	ExMotionFlags_FLAG_horseback = 16777216
	agent_ExMotionFlags_FLAG_horseback = 16777216
	ExMotionFlags_FLAG_Weapon_Cannot_be_flipped = 134217728
	ExMotionFlags_FLAG_Weapon_With_Anim = 268435456
	ExMotionFlags_FLAG_Helm_With_Anim = 536870912
	ExMotionFlags_FLAG_Shield_With_Anim = 1073741824
	//Tactical Orders
	
	TacticsOrder_FLAG_pikewall = 1

	TacticsOrder_FLAG_garrison = 134217728
	//TacticsOrder_FLAG_ShieldWall = 134217728
	

	TacticsOrder_KILL_FLAG_Equipment_Tactics = ~(1 + 8 + 16)


	//InstantStates
	ProcessInstantState_FLAG_overheal = 1
	ProcessInstantState_FLAG_blind = 2
	ProcessInstantState_FLAG_magic_nullifying = 4
	ProcessInstantState_FLAG_bladedance = 8
	ProcessInstantState_FLAG_shield_covered = 16
	ProcessInstantState_FLAG_shield_covered_double_check = 32
	ProcessInstantState_FLAG_climb_hill = 64
	ProcessInstantState_FLAG_immune_to_physical_attack = 128


	//MovementOrder
	//#-3 = WP_chasing_end -2 = returned -1 = do_not_move, 0 = free, 1 = moving, 2 = move_ordered, 3= force_moving, 4 = dashorknockback 5=mounting, 6=garrison 11= fleeing

	MovementOrder_TYPE_returned = -2
	MovementOrder_TYPE_do_not_move = -1
	MovementOrder_TYPE_moving = 1
	MovementOrder_TYPE_move_ordered = 2
	MovementOrder_TYPE_prioritize_moving = 3
	MovementOrder_TYPE_force_moving = 4

	MovementOrder_TYPE_fleeing = 11


	// Beware, ActionFlag can easily be initialized by some skill functions since at the beginning the slot is not expected as a bit holder variable
	ActionFLag_FLAG_Hold_direction = 1
	ActionFlag_FLAG_Walking = 2 //s[v[4558] + :agent_id ]
	ActionFlag_FLAG_Heading_other_agent = 4 //s[103]
	ActionFlag_FLAG_Trying_to_stop = 8 //s[104]
	ActionFlag_FLAG_Turn_to_ordered_Direction = 16 //s[104]
	ActionFlag_FLAG_Already_set_ord_dir = 32
	
	// Agent Type
	AgentType_Simple_Agent = 1
	AgentType_Layered_Agent = 3
	AgentType_Static_Agent = 11

	AgentType_DEAD_Simple_Agent = -1
	AgentType_DEAD_Static_Agent = -11


	// AA bits
	AABits_FLAG_AntiInf = 1
	AABits_FLAG_AntiArcher = 2
	AABits_FLAG_AntiCav = 4
	AABits_FLAG_AntiMage = 8
	AABits_FLAG_AntiSiege = 16
	AABits_FLAG_AntiCiv = 64
	AABits_FLAG_AntiBuilding = 128
	AABits_FLAG_AntiBuilding_SUPER = 256 // for Siege Ram
	AABits_FLAG_NOT_AntiBuilding = 512 // ???????????????????????????????????????
	AABits_FLAG_CrackingShield = 1024
	AABits_FLAG_DevastatingStrikes = 2048
	AABits_FLAG_Trample = 4096
	AABits_FLAG_AntiHero = 8192
	AABits_FLAG_AntiDragon = 16384
	AABits_FLAG_AntiAir = 65536
	AABits_FLAG_CrackingShieldBONUS = 131072
	AABits_FLAG_BladeDance = 262144 
	AABits_FLAG_Camel = 524288
	AABits_FLAG_FatalBlow = 1048576 // bit for daggers


	Formbits_FLAG_Line1 = 1
	Formbits_FLAG_Line2 = 2
	Formbits_FLAG_Line3 = 4
	Formbits_FLAG_Line4 = 8
	Formbits_MASK_Lines = 1+2+4+8

	//Stances
	DIR_RIGHT = 1
	DIR_LEFT = 0
	ORD_AGG = 0
	ORD_DEF = 3
	ORD_STD = 1
	ORD_ATK = 2
	ORD_MANU = 4
	
	ORD_SCOUT=6


	//Other

	//SPRITE_DEAD = 0 ???
	//SPRITE_STAND = 0 ???
	ForceSprite_ATTACK = 1
	ForceSprite_MOVE = 3

	Address_agent_inSight_switch_array_head = 2001

	}



	//
	__fn set_new_agent_base_parameter $Lv $HP $SP $AD $AP $AR $MR $HIT $EVA $Crit $MS $WILL {
		agent_Level = $Lv
		//set HP
		agent_MaxHP = $HP
		agent_HP = $HP
		//set SP
		agent_MaxSP = $SP
		agent_SP = $SP
		//
		agent_BaseAD = $AD
		agent_BaseAP = $AP
		agent_BaseAR = $AR
		agent_BaseMR = $MR
		agent_BaseHIT = $HIT
		agent_BaseEVA = $EVA
		agent_BaseCrit = $Crit
		agent_BaseMS = $MS
		agent_BaseWill = $WILL
	}















	//STATICS
	defv{
	

	agent_static_unit_slot_1 = 741
	agent_static_ReserveAmount = 770

	agent_static_AutoQue = 813

	agent_static_Attribution_flag = 811
	agent_static_Obj_flag = 820
	agent_static_WorkTarget = 821
	agent_static_Spritepattern = 850
	agent_Static_Assigned_worker_counter = 856

	// wreck system (for dead body of static agents)
	agent_static_DEAD_wreck_Offset_MilX = 861 // X * 10000
	agent_static_DEAD_wreck_Offset_MilY
	agent_static_DEAD_wreck_MilPixVx // Vx * 1000
	agent_static_DEAD_wreck_MilPixVy
	agent_static_DEAD_wreck_Timer
	agent_static_DEAD_wreck_Timer_End
	agent_static_DEAD_wreck_Angle
	agent_static_DEAD_wreck_Angle_v
	agent_static_DEAD_wreck_Sprite_Width //
	agent_static_DEAD_wreck_Sprite_Height


	}
	def STATIC_AGENT_WRECK_SYSTEM_DATA_SIZE = 10

	def{
		AgentBits_STATIC_FLAG_No_function = 1024
		AgentBits_STATIC_FLAG_Ignore_morton = 2097152
	}


	//Victims var for attack check
	defv{ // use Ptr11 for victim pointer

		address_victim_buffer_head = 740000
		victim_AgentType = 740001
		victim_AgentBits = 740003
		victim_RelativeX = 740007
		victim_RelativeY = 740008
		victim_Morton = 740009
		victim_Width = 740010
		victim_Height = 740011
		victim_MilPixVx = 740012
		victim_MilPixVy = 740013
		victim_MilPixVab = 740014

		victim_TargetAgentID = 740018
		victim_MapX = 740026
		victim_MapY = 740027
		victim_AATimer = 740028
		victim_AI_decision_bits = 740033
		victim_AI_routine_bits = 740034
		victim_Cohort_ID = 740035
		victim_MoveTypeBits = 740038
		victim_ColDimension = 740039
		victim_getTerrainElevation = 740057
		victim_SaveActualTeamID = 740058
		victim_Skin = 740063 // 0=Rtpian, 1=Nord, 2= Azghazi, 6= female ...This parameter is for UserCharactors
		victim_Race = 740064
		victim_PerkFlagBits1 = 740065
		victim_PerkFlagBits2 = 740066	

		victim_ScriptFlags = 740068

		victim_Buff1 = 740071

		victim_BuffAmount = 740079





		victim_InCombatTimer = 740080
		victim_MeleeFightTimer = 740081
		victim_HitMoveTimer = 740082
		victim_ShieldMotionTimer = 740083
		victim_DodgeTimer = 740085
		victim_BuffTimer1 = 740086


		victim_TeamID = 740100
		victim_UnitID = 740101
		victim_UnitType = 740102
		victim_AAType = 740103 //0 = melee, 1 = ranged, 2 = point, 3 = shoot, 4 = function
		victim_Level = 740104
		victim_MaxHP = 740105
		victim_HP = 740106

		victim_MaxSP = 740107
		victim_SP = 740108
		victim_BaseAD = 740109
		victim_BaseAP = 740110
		victim_MaxAR = 740138
		victim_BaseAR = 740111
		victim_BaseMR = 740112
		victim_BaseHIT = 740113
		victim_BaseEVA = 740114
		victim_BaseCrit = 740115
		victim_BaseMS = 740116
		victim_BaseRange_max = 740117
		victim_BaseRange_min = 740118
		victim_BaseAS = 740119 // (4800 - [AS])

		victim_AAMotion = 740120
		victim_AACost = 740121
		victim_AA_ARorMR = 740122
		victim_AAElement=740123
		victim_AABits=740124
		victim_AddMotionBits = 740125
		victim_ExMotionFlags = 740126

		victim_AAamount = 740127
		victim_AAvelocity = 740127
		victim_AAtime = 740128


		victim_AASfx = 740129
		victim_AAFunction = 740130
		victim_BaseRegHP = 740131
		victim_Shield_Value = 740135
		victim_AA_AR_effectiveness = 740136
		victim_AA_AR_penetration = 740137
		//victim_MaxAR = 740138
		victim_BaseWill = 740139
		victim_BaseObjBit = 740140
		victim_Culture_Icon = 740222
		victim_TakenDamageMultiplier = 740229
		victim_ShieldBreakResistance = 740234
		victim_ShieldRangedProtection = 740235

		victim_static_SprWidth_OneUnit = 740238


		victim_CritChanceReduction =  740239
		victim_CritDamageReduction = 740240
		victim_StanceOrder = 740241
		victim_MovementOrder = 740242
		victim_ActionState = 740243
		victim_Direction = 740244
		victim_TacticsOrderFlag = 740248
		victim_KnockBackTimer = 740249
		
		victim_ForceSprite = 740250
		victim_MainWeaponID = 740251
		victim_MainShieldID = 740252

		victim_static_ownership = 740255
		victim_Static_Assigned_worker_counter = 740256 

		victim_Morale = 740260
		victim_ProcessAD = 740261
		victim_ProcessAP = 740262
		victim_ProcessAR = 740263
		victim_ProcessMR = 740264
		victim_ProcessHIT = 740265
		victim_ProcessEVA = 740266
		victim_ProcessCrit = 740267
		victim_ProcessMS = 740268
		victim_ProcessRange_max = 740269

		victim_ProcessRange_min = 740270
		victim_ProcessAS = 740271
		victim_ProcessHPreg = 740272
		victim_ProcessSPReg = 740273
		victim_ProcessObjBit = 740274
		victim_ProcessWill = 740275
		victim_ProcessCamoValue = 740276
		victim_ProcessInstantState = 740277

		victim_static_unit_to_be_built = 740280
		victim_static_resource_type = 740281

		victim_ShieldFlash = 740284
		victim_2hweapon_stain = 740285
		victim_LastPictureIndex = 740290 
		victim_R = 740291
		victim_G = 740292
		victim_B = 740293
		victim_FlashType = 740295
		victim_PictArray = 740299


		victim_DEAD_beheadTimerEnd = 740288
		victim_DEAD_HeadAngleV = 740289
	}

	// for victim static
	defv {
			victim_static_DEAD_wreck_Offset_MilX = 740261 // 739400 + agent_static_DEAD_wreck_Offset_MilX // X * 10000
			victim_static_DEAD_wreck_Offset_MilY
			victim_static_DEAD_wreck_MilPixVx // Vx * 1000
			victim_static_DEAD_wreck_MilPixVy
			victim_static_DEAD_wreck_Timer
			victim_static_DEAD_wreck_Timer_End
			victim_static_DEAD_wreck_Angle
			victim_static_DEAD_wreck_Angle_v
			victim_static_DEAD_wreck_Sprite_Width //
			victim_static_DEAD_wreck_Sprite_Height

	}

	//Skill var for attack check
	defv{ 

	skill_Slot_in_agent = 580
	skill_ID = 581
	skill_MainFunction = 582
	skill_Type = 583
	skill_Usage = 584
	skill_MotionFrame = 585
	skill_Extramotion_ID = 586 //1 = no motion at all
	skill_Cost = 587 
	skill_Cooldown_Time = 588 
	skill_Targx = 590
	skill_Range_max = 592
	skill_Range_min = 593

	skill_AutoCastFlags = 600

	}

	def{
	skill_Array_size = 20
	Type_PassiveSkl = 0
	Type_LinerSkl = 1
	Type_PointSkl = 2
	Type_TargetSkl = 3
	Type_AoESkl = 4

	Usage_Extra = -1
	Usage_Damage = 0
	Usage_Heal = 1
	Usage_Buff = 2

	Const_Function_do_nothing = 1899
	}
	
	defs bool_agent_is_clickable_head = 3001
	def Adrs_clickable_switches_head_MINUS1 = __id(bool_agent_is_clickable_head) - 1
})


	defv{ // temporary buffer for agent

		tempbuffer4agt_AgentType = 740301
		tempbuffer4agt_AgentBits = 740303
		tempbuffer4agt_RelativeX = 740307
		tempbuffer4agt_RelativeY = 740308
		tempbuffer4agt_Morton = 740309
		tempbuffer4agt_Width = 740310
		tempbuffer4agt_Height = 740311
		tempbuffer4agt_MilPixVx = 740312
		tempbuffer4agt_MilPixVy = 740313
		tempbuffer4agt_MilPixVab = 740314

		tempbuffer4agt_TargetAgentID = 740318
		tempbuffer4agt_MapX = 740326
		tempbuffer4agt_MapY = 740327
		tempbuffer4agt_AATimer = 740328
		tempbuffer4agt_AI_routine_bits = 740334
		tempbuffer4agt_Cohort_ID = 740335
		tempbuffer4agt_MoveTypeBits = 740338
		tempbuffer4agt_ColDimension = 740339
		tempbuffer4agt_getTerrainElevation = 740357
		tempbuffer4agt_SaveActualTeamID = 740358
		tempbuffer4agt_Skin = 740363 // 0=Rtpian, 1=Nord, 2= Azghazi, 6= female ...This parameter is for UserCharactors
		tempbuffer4agt_Race = 740364
		tempbuffer4agt_PerkFlagBits1 = 740365
		tempbuffer4agt_PerkFlagBits2 = 740366	

		tempbuffer4agt_Buff1 = 740371

		tempbuffer4agt_BuffAmount = 740379





		tempbuffer4agt_InCombatTimer = 740380
		tempbuffer4agt_MeleeFightTimer = 740381
		tempbuffer4agt_HitMoveTimer = 740382
		tempbuffer4agt_ShieldMotionTimer = 740383
		tempbuffer4agt_DodgeTimer = 740385
		tempbuffer4agt_BuffTimer1 = 740386


		tempbuffer4agt_TeamID = 740400
		tempbuffer4agt_UnitID = 740401
		tempbuffer4agt_UnitType = 740402
		tempbuffer4agt_AAType = 740403 //0 = melee, 1 = ranged, 2 = point, 3 = shoot, 4 = function
		tempbuffer4agt_Level = 740404
		tempbuffer4agt_MaxHP = 740405
		tempbuffer4agt_HP = 740406
		tempbuffer4agt_MaxSP = 740407
		tempbuffer4agt_SP = 740408
		tempbuffer4agt_BaseAD = 740409
		tempbuffer4agt_BaseAP = 740410
		tempbuffer4agt_MaxAR = 740438
		tempbuffer4agt_BaseAR = 740411
		tempbuffer4agt_BaseMR = 740412
		tempbuffer4agt_BaseHIT = 740413
		tempbuffer4agt_BaseEVA = 740414
		tempbuffer4agt_BaseCrit = 740415
		tempbuffer4agt_BaseMS = 740416
		tempbuffer4agt_BaseRange_max = 740417
		tempbuffer4agt_BaseRange_min = 740418
		tempbuffer4agt_BaseAS = 740419 // (4800 - [AS])

		tempbuffer4agt_AAMotion = 740420
		tempbuffer4agt_AACost = 740421
		tempbuffer4agt_AA_ARorMR = 740422
		tempbuffer4agt_AAElement=740423
		tempbuffer4agt_AABits=740424
		tempbuffer4agt_AddMotionBits = 740425
		tempbuffer4agt_ExMotionFlags = 740426

		tempbuffer4agt_AAamount = 740427
		tempbuffer4agt_AAvelocity = 740427
		tempbuffer4agt_AAtime = 740428


		tempbuffer4agt_AASfx = 740429
		tempbuffer4agt_AAFunction = 740430
		tempbuffer4agt_BaseRegHP = 740431
		tempbuffer4agt_Shield_Value = 740435
		tempbuffer4agt_AA_AR_effectiveness = 740436
		tempbuffer4agt_AA_AR_penetration = 740437
		//tempbuffer4agt_MaxAR = 740438
		tempbuffer4agt_BaseWill = 740439
		tempbuffer4agt_BaseObjBit = 740440
		tempbuffer4agt_Culture_Icon = 740522
		tempbuffer4agt_TakenDamageMultiplier = 740529
		tempbuffer4agt_ShieldBreakResistance = 740534
		tempbuffer4agt_ShieldRangedProtection = 740535

		tempbuffer4agt_static_SprWidth_OneUnit = 740538


		tempbuffer4agt_CritChanceReduction =  740539
		tempbuffer4agt_CritDamageReduction = 740540
		tempbuffer4agt_StanceOrder = 740541
		tempbuffer4agt_MovementOrder = 740542
		tempbuffer4agt_ActionState = 740543
		tempbuffer4agt_Direction = 740544
		tempbuffer4agt_TacticsOrderFlag = 740548
		tempbuffer4agt_KnockBackTimer = 740549
		
		tempbuffer4agt_ForceSprite = 740550
		tempbuffer4agt_MainShieldID = 740552

		tempbuffer4agt_Formbits = 740559

		tempbuffer4agt_Morale = 740560
		tempbuffer4agt_ProcessAD = 740561
		tempbuffer4agt_ProcessAP = 740562
		tempbuffer4agt_ProcessAR = 740563
		tempbuffer4agt_ProcessMR = 740564
		tempbuffer4agt_ProcessHIT = 740565
		tempbuffer4agt_ProcessEVA = 740566
		tempbuffer4agt_ProcessCrit = 740567
		tempbuffer4agt_ProcessMS = 740568
		tempbuffer4agt_ProcessRange_max = 740569

		tempbuffer4agt_ProcessRange_min = 740570
		tempbuffer4agt_ProcessAS = 740571
		tempbuffer4agt_ProcessHPreg = 740572
		tempbuffer4agt_ProcessSPReg = 740573
		tempbuffer4agt_ProcessObjBit = 740574
		tempbuffer4agt_ProcessWill = 740575
		tempbuffer4agt_ProcessCamoValue = 740576
		tempbuffer4agt_ProcessInstantState = 740577
		tempbuffer4agt_ShieldFlash = 740584
		tempbuffer4agt_2hweapon_stain = 740585
		tempbuffer4agt_LastPictureIndex = 740590 
		tempbuffer4agt_R = 740591
		tempbuffer4agt_G = 740592
		tempbuffer4agt_B = 740593
		tempbuffer4agt_FlashType = 740595
		tempbuffer4agt_PictArray = 740599


		tempbuffer4agt_DEAD_beheadTimerEnd = 740588
		tempbuffer4agt_DEAD_HeadAngleV = 740589
	}


//---------------------------------
// agent file system 
//---------------------------------

// file name buffer for agent
deft {

}


__fn checkItemPicFileName $source $slot $name {
	
	@if t[$source].contains "spr_" {
		regs1.asg $name
		regs1.split ("spr_",regs1,reg9)
		t[__id($slot)].asg regs1
		v[1930] = 1 // has sprite

	}.else bl{
		t[__id($slot)].asg $name

	}

	@if t[$source].neq "" {
		t[__id($slot)].cat t[$source]
		v[1930] = 1 // has sprite

	}.else bl{
		t[__id($slot)].cat "0"
		v[1930] = 0 // doesn't have sprite

	}
}


