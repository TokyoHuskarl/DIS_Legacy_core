# メモ
v[3401..3600] が解放されたかも
v[3601~]をAIサーチテーブルとして使ってるけど、溢れそうだから注意。

# 必要要素
選択システムの再調整
  - 建物との重なりで建物を優先する処理を作らないと滅びる
DrawingにDrawn in screen flagチェックいらない説
## 翻訳
- ファクション説明の英訳
- ボーナスをdeepLにかける？

## TODO
- RadioDialogが物故割れてる
- バクラヴァ国のユニットを拡充していく
- 建物のｊｓ処理化を進める

## ディレクトリ整理
- FaceSetはけす
- CharSetも消せるのでは..?
- Moduleにつっこむ？

## js導入
- js導入開始

### UIビルダ
- インプットボックス
- プルダウンメニュー
- 文字メニュー

- 新規通過点アクション


## 修正
- 到達不能地点へ移動しようとすると無限に経路探索を繰り返してしまう
- 前からあるやつ
	- 高低差があると選択位置がずれるやつを治す
	- セーブ画面でクラッシュする
		- セーブ処理が完遂する前に落ちている
	- 金のクリックがちょっとズレる
	- 帝国の崩壊の挙動がおかしい。
	- 兵舎のアップグレードが物故割れるバグ
	- 建物建築の表示が崩れる
		- 怪しいのは操作周りの変数

- 新しいやつ
	- コホート単位での戦闘感知AIが壊れてる?
		- 索敵AIの変更が響いてるかも？
	- 操縦モードが壊れとる
	- チャームが物故割れとる
	- 遅滞防御を押すと選択ができなくなる?
	- 装甲騎兵の動きがおかしい。コストもおかしい。
		- 装甲騎兵がいると建築時建物の表示がおかしい?
	- ゴブリンが半裸の時の見た目がおかしい
	- 刀の表示優先度が壊れてる
	- 建設予定地が消えた?
	- AI挙動がおかしい(持ち替え可能な弓と、騎兵)
	- マウスの開始位置がおかしいょ

- コホート登録を切り替える
- 建物建築時にレイトレーシングの関係で変になることある
- ID置き換えが完全一致naってない
- 破城槌のAIがおかしい
- クラシック島でsaveするとundefinedが出る
- エンピリオンガードが出ないことがあった？
- インタプリタ変数衝突の回避
- !無理やりチーム限界数以上のユニットを生成しようとすると落ちる
- 味方コホートのセットで40体上限を超えると落ちる
- 説明とLoreの分離
- 壁にぶち当たったときの処理をどうするのかを決める必要がある
- NeedWPtoReachObjがどこで起きてるのかを突き止めて、Main側でチェックするフラグとなりうるようにしないと、敵検索壁ぶつかりからのあれでRayを飛ばさない
- 予後、アリーナの指示は経路探索中のユニットに出さないようにする?
- 相対座標の問題をどうにかして解決するべきか…
- エンデュランスのWaveカウントが物故割れることがある?
- 天帝，インペリアルカタパルトで何故か生成が詰まる?

# ゲーム要素アイデア
- 陣形
- 60人まで部隊登録数を増やす
- 民間人のもCtrlクリックによる経路探索をするようにする

## 要検討
- 労働者の振る舞い
	- 建物で労働者が詰まるのをどうにかする
- 当たり判定が消えてない！
  - 弾の当たり判定が900体以上のユニットの出撃を見込んでいない。
- 弾のリファクタリング
- 破城槌のアニメ
- 経路探索中のユニットの挙動についてよく考えてリメイクしましょう
- 壁越しの挙動どうすんの
  - たどり着けないとあきらめちゃうけど…
- ソースの整理が必要
  - とりあえずgeneralファイル以外ではcevのセットをしないようにして、まとめられる処理はまとめて一つのファイルで管理するようにする
- 重心等みてからの指示の際、マップ外が移動先として指定された場合は命令を実行しないように変更..?
  - 一応やったが、移動指示周りの処理一元化が望ましいため検討する。
- Moraleの処理を軽量化できるはず
- コリジョンがやっぱり機能してないときがある気がする?

## 推定解決
- A＊のどこかでポインタを破損させることがある Arena11セーブ参照
  - ポインタの指定がおかしかったのを直した。
- アリーナのクラッシュはたぶん経路探索が原因?
  - 経路探索ではなくピクチャ配列バグのせいだった可能性高し？
- なんか建物が優先されてターゲットされている疑惑がある
  - AIのピクチャ配列からのバグのせいでした
- ピクチャ配列の破損でおきる諸々シリーズ
  - root空間の処理が上手く行ってないのでは。
  - 当たり判定も壊れている、押し出し判定があるものとないものがある
  - root空間検索の何かが致命的にぶち壊れている（最新Saveを使うこと）
  - やはりチームデータが物故割れてるので要確認
  - 建物の検索も壊れている
    - 最終的に全廃して解決。
- save7，ユニット死亡で落ちる？ <- 何故かProjectileのv[312]で競合が起きて落ちるようだった…おそらく，今後は一時変数の数について考慮が必要か
  - 一応直している。これはログとして残しておくべきか？
- 専用の領域を割り当ててあげて、経路探索をさらに高速化する
  - だめです　あんまり効果なさそう
  - ScaleScriptはNsLibへ統合

## 雑多
- 980まで最大Agent数を上げる  
要処理  
- どかせる  
274001~274500 MapSimpleTriggersConditions 500  
274501~275000 MapSimpleTriggersVar 500
- どっかに置く  
275001~280000 ParticleEffecter
- ???
280001~290000 ObjSort  
290001~300000 ObjSortsave  
- アクセサリー分離
- モンゴルっぽい馬と兜あと槍
- 遠投投石機

- アーキンバリッジ  
- ブラスター  
- 矢のカス当たり
- 矢の角度
- 投げ物リロードの仕様  
- 戦術スコア？
- ポテチリメイク
- Denys氏提案のでかいメイス振り回しボーイのヒーロー化（枠はどこに？）

- パッシブの範囲 alt機能
- 攻撃指示のあとの復帰
- オルクやくざ
- オルク縄文人
- 船 - ノード拡張必須
- 完全飛行ユニット？
- 駐留？

- 死神リストを作る? インフォメーションもセットで扱う
- 新実績（かたつむりとか）

## 内政関連
- まずはリファクタリングしてみる
- 実は農民の仕事は相当重いという疑惑がある

## AI関連
- 全く不明

## ノード関連
- 拡張する？
- ~~マップ関連の変数のほとんどはピクチャバッファへ収納可能かもしれない~~



# 設計アイデア


## SS上で扱える疑似構造体構築（DIS仕様）  
- CSVより簡素かつ必要な部位のみを記載して利用可能にする  
- 既存のデータ（CSV記載等）から継承した上でSSから任意のパラメータを変更できるようにする  
- 兵士データについてはヴァーレントゥーガ/elonaのCNPC/MBのtroopをモデルにして設計  
- 将来的にはユニークキャラクターも読み込んでいる構造体データにアクセスして扱うように？（Warband方式）  
- すでに定義された構造体からは要素を（SSを噛ませて）簡単に持ってこれるようにする（MBのget関数の如きを想起せよ）

### 構造体を用いた弾丸やエフェクト等のSS側からの定義
#### Objective 
- Mod制作やマップ単発のエフェクト等の導入を容易にする  
- VTあじ

#### 問題点
- 重さ・自由度・シンプルさ・データ入力手段の混線によって生じうるカオス

## マップビルダ
- 兵士アイコン出力
- ユニット配置メニュー(プルダウンメニュー必須)

## NsLib
じつはあんまり役に立たないという説がある

### もらいもの
- 疑似乱数シード（やべえ氏）

## SS全般
- ピクチャ配列破損に対応してDIS専用に切り替え
    - SSに疑似パイプラインをつける？  
    - 関数ネスト
    - 返り値や引数評価の問題
    - 安定性？
    - 変数・関数定義の仕様

## Yish全般
- ほぼ白紙化（ピクチャ配列の破損を確認したため）
    - どれくらいのピクチャID割当を求めるのか <-中規模構成の場合は最大でも5つ程度で設定したい。 最小構成の場合はインプットボックスとインデックス表示のみで２個
    - ログ・スクリーン更新・Tab機能・コマンドログ・Bash的ショートカット
    - 変数Watchdog 簡易UI補助機能
    - カメラワーク・動作指定補助機能をコマンドから呼び出せるようにする
    - 一定のレンジのキーの動作を監視し，毎フレームごとに文字列バッファへデミリタとともに記録，終了時にテキストとしてエクスポートし，インポートすることで同様の操作を自動的に行うキー入力動作監視システム

## その他
- $HOMEは特段の指定がない限りゲームディレクトリ(RPG_RT.exeがある場所)とする
- disrm.txt,ssrm.txtは~/scripts/に生成
- yishrcは~/yish/に生成(yishディレクトリと$HOMEがわかれているのは気持ち悪いがあくまで補助ツールというスタンスでいく)
- dis_profile.txtは~/user/に生成

# 既知の問題
STATICデータ登録簡略化が動作してない  
クルシラのAI  
変な骨が出る？（落ち着いたら聞く）  


# 他の人とのやりとりが必要なもの

## 確定
***権利については各個プランBを考えておく***

### BGM
- 寿司のテーマ（*イメージ伝え済み*）
- 帝国のテーマ（RoRのテーマっぽく）
- VS機動野戦軍（ToGlory置換）

### 権利(可能な範囲で)
- **!!!GGGとEULA!!!**
- マップチップと建物チップ(がらくた氏，たぶん大丈夫だが伺いは立てる)
- まうぶれのおもしろ音声を抜く
- 弓矢の音が商用禁止だった気がする

## 予備的な案

### 英訳
- G.bro氏に伺い立てる（シェアウェアなのを鑑みると断られそう・協力するならば，どちらかというと統合refwikiのほうに噛んでほしい）

### BGM
- ポテチ人のテーマ
- 竜族のテーマ（これいる？）

### 素材
- Aftermathのタイトル絵

### 権利(可能な範囲で)
- タイトル絵著作財産権（Skeb規定から個別の交渉が必須。Aftermathタイトルと選択的関係）
- 大人なすーん（必要なさそうだが一応，グラフィック依頼にシフトする可能性あり）
- その他効果音ライセンス確認

### コードまわり
- 日本語入力（必要か？処理できるか？）の借用あるいは埋め込み -　*2bytes文字は扱いたくないが，需要はあると思われる……*
- 乱数生成cevの埋め込み(偏りある疑惑については聞いておく)

# 野望

### Steam
- ページ作る(GGGから確認取れ次第)
- 税務情報等を整える
- 5$

### 宣伝
- とりあえず動画を撮る
- ローンチのあれをあれする

### ルーリキアキャンペーン
- ローマン・ラウリィ "Roman Lauriy"とすべての無名戦士に捧ぐ


# その他
竜殺  
